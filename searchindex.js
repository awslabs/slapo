Search.setIndex({docnames:["gallery/index","gallery/quick-start","gallery/sg_execution_times","genindex","index","python_api/index","python_api/initialization","python_api/model_dialect/deepspeed/engine","python_api/model_dialect/deepspeed/index","python_api/model_dialect/deepspeed/pipeline","python_api/model_dialect/index","python_api/model_dialect/registry","python_api/op/cross_entropy","python_api/op/index","python_api/op/linear","python_api/pattern","python_api/pipeline","python_api/root","python_api/schedule","python_api/tracer","scripts/README","setup/index"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":5,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,"sphinxcontrib.bibtex":9,sphinx:56},filenames:["gallery/index.rst","gallery/quick-start.rst","gallery/sg_execution_times.rst","genindex.rst","index.rst","python_api/index.rst","python_api/initialization.rst","python_api/model_dialect/deepspeed/engine.rst","python_api/model_dialect/deepspeed/index.rst","python_api/model_dialect/deepspeed/pipeline.rst","python_api/model_dialect/index.rst","python_api/model_dialect/registry.rst","python_api/op/cross_entropy.rst","python_api/op/index.rst","python_api/op/linear.rst","python_api/pattern.rst","python_api/pipeline.rst","python_api/root.rst","python_api/schedule.rst","python_api/tracer.rst","scripts/README.rst","setup/index.rst"],objects:{"":[[17,0,0,"-","slapo"]],"slapo.Database":[[17,2,1,"","commit"],[17,2,1,"","load"]],"slapo.LinearWithSeparateBias":[[17,2,1,"","forward"]],"slapo.ModulePattern":[[17,2,1,"","forward"]],"slapo.OrderedDict":[[17,2,1,"","clear"],[17,2,1,"","copy"],[17,2,1,"","fromkeys"],[17,2,1,"","items"],[17,2,1,"","keys"],[17,2,1,"","move_to_end"],[17,2,1,"","pop"],[17,2,1,"","popitem"],[17,2,1,"","setdefault"],[17,2,1,"","update"],[17,2,1,"","values"]],"slapo.Pattern":[[17,2,1,"","forward"]],"slapo.Space":[[17,2,1,"","cfg_dict_to_str"],[17,2,1,"","clone"],[17,2,1,"","create_symbol"],[17,2,1,"","log_space"],[17,2,1,"","next"],[17,2,1,"","reset"],[17,2,1,"","to_dict"]],"slapo.Symbol":[[17,2,1,"","add"],[17,2,1,"","fix_at"],[17,2,1,"","is_fixed"]],"slapo.initialization":[[6,4,1,"","init_empty_weights"],[6,4,1,"","init_on_device"]],"slapo.model_dialect":[[11,0,0,"-","registry"]],"slapo.model_dialect.deepspeed":[[7,0,0,"-","engine"],[9,0,0,"-","pipeline"]],"slapo.model_dialect.deepspeed.engine":[[7,4,1,"","init_ds_engine"]],"slapo.model_dialect.deepspeed.pipeline":[[9,1,1,"","DeepSpeedPipeStageWrapper"],[9,1,1,"","WrappedTypeCode"],[9,4,1,"","analyze_tie_ranks"],[9,4,1,"","decode_metadata"],[9,4,1,"","deepspeed_pipe_engine"],[9,4,1,"","encode_metadata"],[9,4,1,"","flat_and_name_tensor_list"],[9,4,1,"","flatten"],[9,4,1,"","get_simple_nested_list_str"],[9,4,1,"","unflatten"]],"slapo.model_dialect.deepspeed.pipeline.DeepSpeedPipeStageWrapper":[[9,2,1,"","forward"]],"slapo.model_dialect.registry":[[11,4,1,"","get_all_dialects"],[11,4,1,"","get_dialect_cls"],[11,4,1,"","register_model_dialect"]],"slapo.op":[[12,0,0,"-","cross_entropy"],[14,0,0,"-","linear"]],"slapo.op.cross_entropy":[[12,1,1,"","ParallelCrossEntropy"],[12,4,1,"","vocab_parallel_cross_entropy"]],"slapo.op.cross_entropy.ParallelCrossEntropy":[[12,2,1,"","forward"]],"slapo.op.linear":[[14,1,1,"","FusedQKV"],[14,1,1,"","LinearWithSeparateBias"]],"slapo.op.linear.FusedQKV":[[14,2,1,"","forward"]],"slapo.op.linear.LinearWithSeparateBias":[[14,2,1,"","forward"]],"slapo.partial":[[17,3,1,"","args"],[17,3,1,"","func"],[17,3,1,"","keywords"]],"slapo.pattern":[[15,1,1,"","ModulePattern"],[15,1,1,"","Pattern"]],"slapo.pattern.ModulePattern":[[15,2,1,"","forward"]],"slapo.pattern.Pattern":[[15,2,1,"","forward"]],"slapo.pipeline":[[16,4,1,"","analyze_tie_weights"]],"slapo.schedule":[[18,1,1,"","DictWithValidation"],[18,1,1,"","ScheduleMetadata"],[18,1,1,"","SubgraphWrapper"],[18,4,1,"","consolidate_model"],[18,4,1,"","init_target_engine"],[18,4,1,"","register_primitive"]],"slapo.schedule.SubgraphWrapper":[[18,2,1,"","forward"]],"slapo.tracer":[[19,4,1,"","trace"]],slapo:[[17,1,1,"","Database"],[17,1,1,"","DictWithValidation"],[17,3,1,"","FunctionType"],[17,1,1,"","LinearWithSeparateBias"],[17,1,1,"","ModulePattern"],[17,1,1,"","OrderedDict"],[17,1,1,"","Pattern"],[17,1,1,"","ScheduleMetadata"],[17,1,1,"","Space"],[17,1,1,"","Symbol"],[17,4,1,"","all_gather_forward_output"],[17,4,1,"","analyze_tie_weights"],[17,4,1,"","consolidate_model"],[17,4,1,"","dataclass"],[17,4,1,"","field"],[17,4,1,"","get_dialect_cls"],[17,4,1,"","get_logger"],[17,4,1,"","get_output_type_after_sharding"],[17,4,1,"","init_empty_weights"],[17,4,1,"","init_target_engine"],[6,0,0,"-","initialization"],[17,1,1,"","partial"],[15,0,0,"-","pattern"],[16,0,0,"-","pipeline"],[17,4,1,"","reduce_backward_grad"],[17,4,1,"","reduce_forward_output"],[17,4,1,"","reduce_scatter_forward_output"],[17,4,1,"","register_primitive"],[17,4,1,"","scatter_forward_output"],[18,0,0,"-","schedule"],[17,4,1,"","trace"],[17,4,1,"","trace_module"],[19,0,0,"-","tracer"],[17,4,1,"","transfer_hooks"]]},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","attribute","Python attribute"],"4":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:attribute","4":"py:function"},terms:{"0":[1,2,9,12,16,17],"00":[1,2],"06":2,"1":[1,9,12,16,17,18],"10":1,"100":1,"1024":1,"11":1,"112kb":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"181":1,"19":1,"1e":1,"2":[1,16,17,18],"20":[1,17],"21":1,"22":1,"23":1,"3":1,"30522":1,"4":1,"4096":1,"5":1,"512":1,"526":17,"571":1,"6":1,"7":1,"733":[1,2],"8":1,"9":1,"case":[1,17],"class":[1,9,11,12,14,15,17,18],"default":[1,12,17],"do":[1,17],"final":[17,18],"function":[1,6,7,9,11,12,14,15,16,17,18,19],"import":[1,21],"int":[9,14,16,17],"new":[1,17],"return":[1,9,14,15,16,17,18],"static":[1,17],"true":[1,6,14,17],"try":1,"while":[6,9,12,14,15,17,18],A:[6,9,17],As:1,For:[1,9,21],If:[1,16,17,21],In:17,It:[4,17],That:1,The:[1,9,16,17,21],To:[1,21],__annotations__:17,__hash__:17,__init__:[1,17],__repr__:17,_c:1,_check:1,_missing_typ:17,_nn:1,abov:1,access:1,across:12,actual:1,ad:[1,17],add:[1,17],address:4,after:[1,9,17],afterward:[9,12,14,15,17,18],alia:17,all:[1,6,9,11,12,14,15,16,17,18],all_gather_forward_output:17,allow_non:[11,17],along:17,alreadi:[1,16,17],also:[1,6,17,21],although:[9,12,14,15,17,18],an:[1,6,17],analyz:[9,16,17],analyze_tie_rank:9,analyze_tie_weight:[16,17],ani:[1,16,17,18,19],annot:[1,17,18],api:4,applic:[17,18],approach:21,ar:[1,6,9,12,14,16,17],arg:[9,15,17],argument:[9,14,17],assign:[9,17],attach:17,attent:1,attribut:[1,17,18],autoconfig:1,avail:[6,17],awslab:21,axi:17,b:[1,17],base:[1,17],base_param:[17,18],batch_siz:12,becaus:[17,18],been:17,befor:17,begin:17,bert:1,bertattent:1,bertembed:1,bertencod:1,bertintermedi:1,bertlay:1,bertlmheadmodel:1,bertlmpredictionhead:1,bertmodel:1,bertonlymlmhead:1,bertoutput:1,bertpredictionheadtransform:1,bertselfattent:1,bertselfoutput:1,between:4,bia:[1,14,17,18],bias_gelu_pattern:1,blow:[6,17],bodi:1,bool:[6,14,16,17],both:17,buffer:[6,17],c:21,call:[1,9,12,14,15,17,18],callabl:[17,18],can:[1,21],candid:17,cannot:1,care:[9,12,14,15,17,18],cd:21,cfg_dict:17,cfg_dict_to_str:17,chang:[4,17,21],check:17,cl:[1,17],clear:17,click:1,clone:[17,21],cls_type:[11,17],code:[1,9],codebas:21,com:21,command:21,commit:17,common:4,commun:9,compar:17,comparison:17,compil:1,comput:[9,12,14,15,17,18],conduct:1,config:[1,9,17],consequenti:1,consolid:[17,18],consolidate_model:[17,18],contain:1,context:[6,17],convert:[4,17],copi:17,correct:12,correspond:17,creat:[1,6,17],create_schedul:1,create_symbol:17,creation:17,cross:12,cross_entropi:13,custom:17,d:17,data:[9,17],databas:17,dataclass:17,dataflow:1,db:17,db_file_nam:17,debug:[1,17],decod:[1,9],decode_metadata:9,decompos:1,decoupl:4,deepspe:[10,17,18],deepspeed_pipe_engin:9,deepspeedpipestagewrapp:9,def:1,default_factori:17,defin:[1,9,12,14,15,17,18],definit:[1,4],defint:1,dens:1,dense_bia:1,dense_weight:1,determin:17,dev:21,develop:21,devic:[6,9,14,17],dialect:[11,17,18],dict:[9,16,17,18,19],dictionari:17,dictwithvalid:[17,18],differ:[16,17],dim:17,dimens:[12,17],dimseion:12,directli:[1,4,21],distribut:[12,17],doc:[17,18],doe:17,doesn:1,download:1,dropout:1,dtype:[14,17],due:17,dunder:17,duplic:17,e:[1,17,21],each:9,easiest:21,effect:21,effici:4,either:[1,17],element:[1,17],elementwise_affin:1,els:17,embed:1,empti:[1,6,17],enabl:[4,6,17,18],encod:[1,9],encode_metadata:9,end:17,engin:[8,9,10,17,18],entropi:12,ep:1,eq:17,error:17,everi:[9,12,14,15,17,18],exactli:1,examin:17,exampl:[1,9],execut:[2,4],exist:17,f:[1,17],factor:12,factori:[17,18],fals:[1,6,11,17,18],feed:1,ffn:1,field:17,fifo:17,file:[2,17],find:1,first:1,fix:17,fix_at:17,fixm:[17,18],flat:9,flat_and_name_tensor_list:9,flatten:[1,9],follow:[1,17,21],form:1,format:9,former:[9,12,14,15,17,18],forward:[1,9,12,14,15,17,18],found:17,fp16:9,framework:[11,16,17,18],from:[1,4,9,14,16,17,21],from_pretrain:1,fromkei:17,frozen:17,full:1,func:17,functiontyp:17,fuse:1,fused_bias_ge_lu_0:1,fusedbiasgelu:1,fusedbiasgelu_0:1,fusedqkv:14,fusion:1,futur:17,fx:[1,9],g:1,galleri:[1,2],gather:17,gelu:1,geluactiv:1,gener:[0,1,17,18],get:[1,11,17],get_all_dialect:11,get_dialect_cl:[11,17],get_logg:17,get_output_type_after_shard:17,get_simple_nested_list_str:9,git:21,github:21,given:[9,17],gpu:9,gradient:17,graph:1,graph_modul:1,graphmodul:[1,9,17,19],group:[12,17],guid:1,ha:17,hash:17,have:[1,16,17,21],help:1,helper:9,here:1,hidden_s:[12,14],hidden_st:[1,14],hidet:5,hierach:1,hook:[9,12,14,15,17,18],hook_typ:17,howev:17,http:21,hub:1,huggingfac:1,i:1,id:[12,16,17],identifi:17,idx:17,ignor:[9,12,14,15,17,18],implement:[1,14,17],in_featur:[1,14,17],includ:[9,17],include_buff:[6,17],inde:1,index:[4,17],infer:17,info:1,inform:9,init:17,init_ds_engin:7,init_empty_weight:[6,17],init_on_devic:6,init_target_engin:[17,18],initi:[5,7,17,18],inner:1,inp:17,inplac:1,input:[14,17],insert:17,instal:[1,4],instanc:[1,9,12,14,15,17,18],instead:[1,9,12,14,15,17,18],inter:9,intermedi:1,intermediate_act_fn:1,invok:[17,18],ipynb:1,is_decod:1,is_fix:17,is_pipeline_partit:[16,17],item:[9,17],iter:17,its:[1,17],itself:4,jit:1,json:1,jupyt:1,just:[1,6,17],k:17,kei:[1,17],keyerror:17,keyword:[1,9,17],kwarg:[7,9,17,18,19],label:12,label_smooth:12,lack:17,languag:4,larg:[1,4],last:17,later:[1,17,18],latter:[9,12,14,15,17,18],layer:1,layernorm:1,len:9,let:1,level:[1,16,17],leverag:1,lib:1,lifo:17,like:17,linear:[1,13,17],linearwithseparatebia:[1,14,17],list:[1,9,17],live:9,load:[1,17],local:1,locat:1,log:17,log_spac:17,logger:17,logit:12,loss:12,loss_fn:9,lve:1,mai:17,main:1,mainli:9,maintain:9,make:[1,9,17,18],manag:[6,17],map:[16,17],match:[16,17],mb:2,memori:[16,17],meta:[6,17],metadata:[9,17],metadata_str:9,method:[9,12,14,15,17,18],micro_batch_s:12,minut:1,mod:[1,9],model:[4,6,7,9,11,17,18,19],model_dialect:5,modifi:[1,14,17],modul:[1,9,12,14,15,16,17,18,19],modulelist:1,modulepattern:[15,17],more:1,move:17,move_to_end:17,must:[12,17],name:[1,9,15,16,17],need:[1,9,12,14,15,17,18],need_dist:[17,18],nest:9,network:1,new_mod:17,next:[1,17],nn:[1,9,14,16,17,18,19],node:1,non:1,none:[1,9,12,14,15,17,18],note:[9,17],notebook:1,noth:17,num_head:14,number:[16,17],object:[16,17],obtain:1,od:17,old:17,old_mod:17,one:[1,9,12,14,15,17,18],onli:[17,18],op:[5,17],oper:[1,17],optim:4,option:[17,18],order:[1,17],ordereddict:17,origin:[1,9,17],original_nam:1,other:[1,17],otherwis:17,out_featur:[1,14,17],output:[1,9,12,17,21],overridden:[9,12,14,15,17,18],p:1,packag:[1,21],padding_idx:1,pair:17,parallel:12,parallelcrossentropi:12,param:[12,17],param_init_fn:[17,18],paramet:[6,9,12,14,16,17,18,19],parent:1,part:1,partial:17,partit:[16,17],pass:[1,9,12,14,15,17,18],path:[1,9],pattern:[1,5,17],pep:17,perform:[1,9,12,14,15,17,18],pip:21,pipelin:[5,8,10,17,18],pipeline_cutting_path:[17,18],pipelinemodul:9,pleas:1,pop:17,popitem:17,position_embed:1,predict:1,present:17,preserv:1,primit:[1,4,17,18],print:[1,9,17,18,21],print_read:1,process:17,processgroup:17,progress:4,provid:[17,21],put:[6,17],py:[1,2],pypi:21,python3:1,python:[1,4,21],pytorch:4,queri:1,quick:[0,2,4],quickli:1,rais:17,ram:[6,17],rang:12,rank:[9,12],re:17,recip:[9,12,14,15,17,18],record:[17,18],recursivescriptmodul:1,reduc:17,reduce_backward_grad:17,reduce_forward_output:17,reduce_scatter_forward_output:17,regist:[9,11,12,14,15,17,18],register_model_dialect:11,register_primit:[17,18],registr:11,registri:10,relat:9,reli:[17,18],rememb:17,remov:17,replai:[17,18],repr:17,reprent:1,requir:1,reset:17,restor:9,result:[1,17],ret:9,retriev:1,revers:9,rich:17,run:[1,9,12,14,15,17,18,21],runtim:[17,18],s:[1,17],same:[1,14,16,17],satisfi:1,scatter:17,scatter_forward_output:17,sch:[1,17,18],sch_metadata:9,schedul:[1,4,5,9,17],schedulemetadata:[9,17,18],script:1,second:1,see:1,self:1,sequence_length:12,set:[4,16,17],setdefault:17,shallow:17,shard:[1,17,18],sharded_s:17,share:[16,17],should:[1,9,12,14,15,16,17,18],silent:[9,12,14,15,17,18],simpl:17,sinc:[1,9,12,14,15,17,18],site:1,size:17,slapo:[5,8,10,13,21],smooth:12,so:[16,17],sourc:[1,6,7,9,11,12,14,15,16,17,18,19,21],space:17,specif:[17,18],specifi:[1,6,17],sphinx:[0,1],split:[12,17],stage:[9,16,17],stage_id:9,stage_id_2_arg_nam:9,stage_modul:9,standalon:1,start:[0,2],state:17,statu:[17,18],store:[1,17],str:[9,16,17,18,19],string:[9,17],structur:[1,9],subclass:[9,12,14,15,17,18],subgraph:1,subgraphwrapp:18,submodul:[1,16,17],subsch:1,successfulli:21,suffix:9,support:[1,16,17,18],sure:[1,9],symbol:17,sync:17,system:1,t1:9,t2:9,t:1,take:[9,12,14,15,17,18,21],tape:[17,18],target:[11,12,17,18],tension:4,tensor:[1,9,12,14,17],tensor_parallel_output_grad:17,thei:1,them:[9,12,14,15,17,18],therefor:[1,6,17],thi:[1,6,9,12,14,15,16,17,18],through:[1,21],thu:4,ti:[9,16,17],tie:[16,17],tie_group:[16,17],tie_weight:[17,18],tie_weight_group:9,time:1,to_dict:17,todo:[17,18],togeth:1,token_type_embed:1,top:[16,17],top_mod:[16,17],topolog:[9,17,18],torch:[1,6,9,12,14,16,17],torchscript:1,total:[1,2],total_stag:9,trace:[1,16,17,19],trace_modul:17,tracer:[1,5],train:4,training_script_arg:17,transfer:17,transfer_hook:17,transform:1,transform_act_fn:1,tunabl:17,tune:17,tupl:[1,16,17,18],two:[1,16,17,21],type:[1,9,14,15,16,17,18],uncas:1,under:[6,17],unflatten:9,unsafe_hash:17,updat:17,update_space_fn:17,us:[1,4,6,9,17,18],usabl:4,user:[1,4],userwarn:1,usr:1,v:17,val:17,valu:[1,9,17],vanilla:1,verifi:21,view:17,vocab:12,vocab_parallel_cross_entropi:12,vocab_parallel_logit:12,wa:17,wai:21,walk:1,want:1,warn:1,we:[1,9,17,18,21],weight:[1,9,16,17,18],what:1,when:[6,12,17,18,21],where:1,wherea:17,whether:[6,16,17,18],which:[6,17],within:[9,12,14,15,17,18],without:[4,9],word_embed:1,world_siz:14,would:[6,17],wrap:[1,9,17,18],wrappedtypecod:9,wrapper:16,x:[1,14,17,18],you:[1,21]},titles:["Gallery","Quick Start","Computation times","Index","Slapo Documentation","Python API","slapo.initialization","slapo.model_dialect.deepspeed.engine","hidet.model_dialect.deepspeed","slapo.model_dialect.deepspeed.pipeline","hidet.model_dialect","slapo.model_dialect.registry","slapo.op.cross_entropy","hidet.op","slapo.op.linear","slapo.pattern","slapo.pipeline","slapo","slapo.schedule","slapo.tracer","Gallery","Installation"],titleterms:{api:5,comput:2,cross_entropi:12,deepspe:[7,8,9],document:4,engin:7,galleri:[0,20],get:4,hidet:[8,10,13],index:3,initi:6,instal:21,linear:14,model:1,model_dialect:[7,8,9,10,11],op:[12,13,14],optim:1,pattern:15,pipelin:[9,16],python:5,pytorch:1,quick:1,refer:4,registri:11,schedul:18,slapo:[1,4,6,7,9,11,12,14,15,16,17,18,19],start:[1,4],submodul:[8,10,13],time:2,tracer:19}})