

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>slapo &#8212; Slapo Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'python_api/root';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="slapo.schedule" href="schedule.html" />
    <link rel="prev" title="Python API" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">Slapo Documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/quick-start.html">Quick Start</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../gallery/attention-single-gpu.html">Optimize Attention Module on A Single Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/mlp-multi-gpu.html">Optimize MLP Module on Multi-Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/debug-print.html">Debugging with Print</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Python API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">slapo</a></li>
<li class="toctree-l2"><a class="reference internal" href="schedule.html">slapo.schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="initialization.html">slapo.initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="pattern.html">slapo.pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipeline.html">slapo.pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracer.html">slapo.tracer</a></li>
<li class="toctree-l2"><a class="reference internal" href="random.html">slapo.random</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="framework_dialect/index.html">slapo.framework_dialect</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="framework_dialect/registry.html">slapo.framework_dialect.registry</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="framework_dialect/deepspeed/index.html">slapo.framework_dialect.deepspeed</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="framework_dialect/deepspeed/engine.html">slapo.framework_dialect.deepspeed.engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="framework_dialect/deepspeed/pipeline.html">slapo.framework_dialect.deepspeed.pipeline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="model_schedule/index.html">slapo.model_schedule</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="model_schedule/api.html">slapo.model_schedule.api</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="op/index.html">slapo.op</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="op/attention.html">slapo.op.attention</a></li>
<li class="toctree-l3"><a class="reference internal" href="op/cross_entropy.html">slapo.op.cross_entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="op/fused_bias.html">slapo.op.fused_bias</a></li>
<li class="toctree-l3"><a class="reference internal" href="op/linear.html">slapo.op.linear</a></li>
<li class="toctree-l3"><a class="reference internal" href="op/mlp.html">slapo.op.mlp</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/awslabs/slapo" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/python_api/root.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>slapo</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="section" id="module-slapo">
<span id="slapo"></span><h1>slapo<a class="headerlink" href="#module-slapo" title="Permalink to this headline"><span>¶</span></a></h1>
<p><strong>Classes:</strong></p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.Database" title="slapo.Database"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Database</span></code></a>([db_file_name])</p></td>
<td><p>A simple database to store the results of tuning in Dict.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.Space" title="slapo.Space"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Space</span></code></a>()</p></td>
<td><p>The tuning space.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.Symbol" title="slapo.Symbol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Symbol</span></code></a>(name, vals)</p></td>
<td><p>A tunable symbol.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.FunctionType" title="slapo.FunctionType"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FunctionType</span></code></a></p></td>
<td><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">function</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.ModulePattern" title="slapo.ModulePattern"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ModulePattern</span></code></a>(name)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.OrderedDict" title="slapo.OrderedDict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OrderedDict</span></code></a></p></td>
<td><p>Dictionary that remembers insertion order</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.Pattern" title="slapo.Pattern"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Pattern</span></code></a>(*args, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.ScheduleMetadata" title="slapo.ScheduleMetadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ScheduleMetadata</span></code></a>([tie_weights, param_tags, ...])</p></td>
<td><p>The metadata of a schedule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.partial" title="slapo.partial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">partial</span></code></a></p></td>
<td><p>partial(func, <a href="#id1"><span class="problematic" id="id2">*</span></a>args, <a href="#id3"><span class="problematic" id="id4">**</span></a>keywords) - new function with partial application of the given arguments and keywords.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.Verify" title="slapo.Verify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Verify</span></code></a>(sch, example_inputs[, device, ...])</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.init_empty_weights" title="slapo.init_empty_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_empty_weights</span></code></a>([enable, include_buffers])</p></td>
<td><p>A context manager under which models are initialized with all parameters on the meta device, therefore creating an empty model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.get_logger" title="slapo.get_logger"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_logger</span></code></a>([name, level])</p></td>
<td><p>Attach to the default logger.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.register_primitive" title="slapo.register_primitive"><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_primitive</span></code></a>()</p></td>
<td><p>Register a primitive to the schedule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.set_random_seed" title="slapo.set_random_seed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_random_seed</span></code></a>([seed, dp_rank, pp_rank, ...])</p></td>
<td><p>Set random seed for reproducibility.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.analyze_tie_weights" title="slapo.analyze_tie_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">analyze_tie_weights</span></code></a>(top_mod, ...)</p></td>
<td><p>Analyze if there is any tie weights (two weights in different module share the same memory) partitioned into different pipeline stages.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.consolidate_model" title="slapo.consolidate_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">consolidate_model</span></code></a>(sch, target[, param_init_fn])</p></td>
<td><p>Consolidate the model weights.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.create_schedule" title="slapo.create_schedule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_schedule</span></code></a>(root[, name, path, parent, ...])</p></td>
<td><p>Create a schedule for the given module and preserve the module hierarchy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.dataclass" title="slapo.dataclass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dataclass</span></code></a>([cls, init, repr, eq, order, ...])</p></td>
<td><p>Returns the same class as was passed in, with dunder methods added based on the fields defined in the class.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.field" title="slapo.field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">field</span></code></a>(*[, default, default_factory, init, ...])</p></td>
<td><p>Return an object to identify dataclass fields.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.get_cuda_rng_tracker" title="slapo.get_cuda_rng_tracker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_cuda_rng_tracker</span></code></a>()</p></td>
<td><p>Get cuda rng tracker.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.get_dialect_cls" title="slapo.get_dialect_cls"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_dialect_cls</span></code></a>(cls_type, target[, allow_none])</p></td>
<td><p>Get the framework dialect class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.init_target_engine" title="slapo.init_target_engine"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_target_engine</span></code></a>(sch, target, **kwargs)</p></td>
<td><p>Initialize the runtime engine for a specific target framework.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.is_module_list" title="slapo.is_module_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_module_list</span></code></a>(module[, name, parent])</p></td>
<td><p>A module list will become nn.Module or fx.GraphModule after tracing, but we still want to treat it as a module list in the schedule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.list_primitives" title="slapo.list_primitives"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list_primitives</span></code></a>([name_only])</p></td>
<td><p>List all available schedule primitives.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.trace" title="slapo.trace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trace</span></code></a>(model, **kwargs)</p></td>
<td><p>Traces a model to a GraphModule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.trace_module" title="slapo.trace_module"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trace_module</span></code></a>(model, **kwargs)</p></td>
<td><p>Traces a model to a GraphModule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.is_random_seed_set" title="slapo.is_random_seed_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_random_seed_set</span></code></a>()</p></td>
<td><p>Check if random seed is set.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.checkpoint" title="slapo.checkpoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">checkpoint</span></code></a>(function, *args[, use_reentrant])</p></td>
<td><p>Checkpoint a model or part of the model.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="slapo.Database">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">Database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Database" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>A simple database to store the results of tuning in Dict.</p>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.Database.load" title="slapo.Database.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>()</p></td>
<td><p>Load the database from the file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.Database.commit" title="slapo.Database.commit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">commit</span></code></a>(key, data)</p></td>
<td><p>Commit the data to the database and update the DB file.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="slapo.Database.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Database.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Database.load" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Load the database from the file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.Database.commit">
<span class="sig-name descname"><span class="pre">commit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Database.commit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Database.commit" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Commit the data to the database and update the DB file.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="slapo.Space">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">Space</span></span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Space" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>The tuning space.</p>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.Space.create_symbol" title="slapo.Space.create_symbol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_symbol</span></code></a>(name, vals)</p></td>
<td><p>Create a symbol in the space.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.Space.next" title="slapo.Space.next"><code class="xref py py-obj docutils literal notranslate"><span class="pre">next</span></code></a>()</p></td>
<td><p>Get the next symbol to fix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.Space.reset" title="slapo.Space.reset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset</span></code></a>()</p></td>
<td><p>Reset the space to the initial state.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.Space.to_dict" title="slapo.Space.to_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_dict</span></code></a>()</p></td>
<td><p>Convert the space to a dict.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.Space.clone" title="slapo.Space.clone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clone</span></code></a>()</p></td>
<td><p>Clone the space.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.Space.cfg_dict_to_str" title="slapo.Space.cfg_dict_to_str"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cfg_dict_to_str</span></code></a>(cfg_dict)</p></td>
<td><p>Convert a config dict to a string for logging and debugging.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.Space.log_space" title="slapo.Space.log_space"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_space</span></code></a>(training_script_args, update_space_fn)</p></td>
<td><p>Print the tuning space for logging.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="slapo.Space.create_symbol">
<span class="sig-name descname"><span class="pre">create_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Space.create_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Space.create_symbol" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Create a symbol in the space. If the symbol already exists:</p>
<ol class="arabic simple">
<li><p>If the symbol is fixed, do nothing;</p></li>
<li><p>Otherwise re-create the symbol, because its candidate values may change
due to other fixed symbols.</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.Space.next">
<span class="sig-name descname"><span class="pre">next</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Space.next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Space.next" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Get the next symbol to fix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.Space.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Space.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Space.reset" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Reset the space to the initial state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.Space.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Space.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Space.to_dict" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Convert the space to a dict. Note that all symbols must be fixed
before calling this function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.Space.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Space.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Space.clone" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Clone the space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.Space.cfg_dict_to_str">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfg_dict_to_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Space.cfg_dict_to_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Space.cfg_dict_to_str" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Convert a config dict to a string for logging and debugging.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.Space.log_space">
<span class="sig-name descname"><span class="pre">log_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_script_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_space_fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Space.log_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Space.log_space" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Print the tuning space for logging.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="slapo.Symbol">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">Symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Symbol" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>A tunable symbol.</p>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.Symbol.add" title="slapo.Symbol.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add</span></code></a>(val)</p></td>
<td><p>Add a value to the symbol.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.Symbol.fix_at" title="slapo.Symbol.fix_at"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_at</span></code></a>(idx)</p></td>
<td><p>Fix the value of this symbol at the given index.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.Symbol.is_fixed" title="slapo.Symbol.is_fixed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_fixed</span></code></a>()</p></td>
<td><p>Check if the value of this symbol has been fixed.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="slapo.Symbol.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Symbol.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Symbol.add" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Add a value to the symbol. If the value is already in the symbol, do nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.Symbol.fix_at">
<span class="sig-name descname"><span class="pre">fix_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Symbol.fix_at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Symbol.fix_at" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Fix the value of this symbol at the given index.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.Symbol.is_fixed">
<span class="sig-name descname"><span class="pre">is_fixed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/autotune/tune.html#Symbol.is_fixed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Symbol.is_fixed" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Check if the value of this symbol has been fixed.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.init_empty_weights">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">init_empty_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_buffers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/initialization.html#init_empty_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.init_empty_weights" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>A context manager under which models are initialized with all parameters on the
meta device, therefore creating an
empty model. Useful when just initializing the model would blow the available RAM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>enable</strong> (<em>bool</em>) – Whether or not to enable this context manager.</p></li>
<li><p><strong>include_buffers</strong> (<em>bool</em>) – Whether or not to also put all buffers on the meta device while initializing.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.get_logger">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">get_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Slapo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/logger.html#get_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.get_logger" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Attach to the default logger.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.register_primitive">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">register_primitive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/primitives/base.html#register_primitive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.register_primitive" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Register a primitive to the schedule.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.set_random_seed">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">set_random_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2013</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">always_enable_tp_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/random.html#set_random_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.set_random_seed" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Set random seed for reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – Random seed. Default is 2013.</p></li>
<li><p><strong>dp_rank</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Data parallel rank. Default is None means no data parallelism.</p></li>
<li><p><strong>pp_rank</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Pipeline parallel rank. Default is None means no pipeline parallelism.</p></li>
<li><p><strong>tp_rank</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Tensor model parallel rank. Default is None means no tensor parallelism.</p></li>
<li><p><strong>always_enable_tp_seed</strong> (<em>bool</em>) – Always enable tensor model parallel seed. This is used when sequence
parallelism is enabled and all dropouts should use different seeds
even they are in the same TP group. Default is False, meaning that
tensor model parallel seed is only enabled with get_cuda_rng_tracker().fork().</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Random seed of this rank.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="slapo.FunctionType">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">FunctionType</span></span><a class="headerlink" href="#slapo.FunctionType" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">function</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="slapo.ModulePattern">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">ModulePattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/pattern.html#ModulePattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.ModulePattern" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.ModulePattern.forward" title="slapo.ModulePattern.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(*args)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="slapo.ModulePattern.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/pattern.html#ModulePattern.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.ModulePattern.forward" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="slapo.OrderedDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">OrderedDict</span></span><a class="reference internal" href="../_modules/collections.html#OrderedDict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.OrderedDict" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Dictionary that remembers insertion order</p>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.OrderedDict.clear" title="slapo.OrderedDict.clear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.OrderedDict.popitem" title="slapo.OrderedDict.popitem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">popitem</span></code></a>([last])</p></td>
<td><p>Remove and return a (key, value) pair from the dictionary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.OrderedDict.move_to_end" title="slapo.OrderedDict.move_to_end"><code class="xref py py-obj docutils literal notranslate"><span class="pre">move_to_end</span></code></a>(key[, last])</p></td>
<td><p>Move an existing element to the end (or beginning if last is false).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.OrderedDict.update" title="slapo.OrderedDict.update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update</span></code></a>([E, ]**F)</p></td>
<td><p>If E is present and has a .keys() method, then does:  for k in E: D[k] = E[k] If E is present and lacks a .keys() method, then does:  for k, v in E: D[k] = v In either case, this is followed by: for k in F:  D[k] = F[k]</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.OrderedDict.keys" title="slapo.OrderedDict.keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">keys</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.OrderedDict.items" title="slapo.OrderedDict.items"><code class="xref py py-obj docutils literal notranslate"><span class="pre">items</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.OrderedDict.values" title="slapo.OrderedDict.values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">values</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.OrderedDict.pop" title="slapo.OrderedDict.pop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pop</span></code></a>(k[,d])</p></td>
<td><p>value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.OrderedDict.setdefault" title="slapo.OrderedDict.setdefault"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setdefault</span></code></a>(key[, default])</p></td>
<td><p>Insert key with a value of default if key is not in the dictionary.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.OrderedDict.copy" title="slapo.OrderedDict.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.OrderedDict.fromkeys" title="slapo.OrderedDict.fromkeys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fromkeys</span></code></a>([value])</p></td>
<td><p>Create a new ordered dictionary with keys from iterable and values set to value.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="slapo.OrderedDict.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None.</span>&#160; <span class="pre">Remove</span> <span class="pre">all</span> <span class="pre">items</span> <span class="pre">from</span> <span class="pre">od.</span></span></span><a class="headerlink" href="#slapo.OrderedDict.clear" title="Permalink to this definition"><span>¶</span></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.OrderedDict.popitem">
<span class="sig-name descname"><span class="pre">popitem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#slapo.OrderedDict.popitem" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Remove and return a (key, value) pair from the dictionary.</p>
<p>Pairs are returned in LIFO order if last is true or FIFO order if false.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.OrderedDict.move_to_end">
<span class="sig-name descname"><span class="pre">move_to_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#slapo.OrderedDict.move_to_end" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Move an existing element to the end (or beginning if last is false).</p>
<p>Raise KeyError if the element does not exist.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.OrderedDict.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <span class="optional">]</span><em class="sig-param"><span class="n"><span class="pre">**F</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None.</span>&#160; <span class="pre">Update</span> <span class="pre">D</span> <span class="pre">from</span> <span class="pre">dict/iterable</span> <span class="pre">E</span> <span class="pre">and</span> <span class="pre">F.</span></span></span><a class="headerlink" href="#slapo.OrderedDict.update" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>If E is present and has a .keys() method, then does:  for k in E: D[k] = E[k]
If E is present and lacks a .keys() method, then does:  for k, v in E: D[k] = v
In either case, this is followed by: for k in F:  D[k] = F[k]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.OrderedDict.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">a</span> <span class="pre">set-like</span> <span class="pre">object</span> <span class="pre">providing</span> <span class="pre">a</span> <span class="pre">view</span> <span class="pre">on</span> <span class="pre">D's</span> <span class="pre">keys</span></span></span><a class="headerlink" href="#slapo.OrderedDict.keys" title="Permalink to this definition"><span>¶</span></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.OrderedDict.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">a</span> <span class="pre">set-like</span> <span class="pre">object</span> <span class="pre">providing</span> <span class="pre">a</span> <span class="pre">view</span> <span class="pre">on</span> <span class="pre">D's</span> <span class="pre">items</span></span></span><a class="headerlink" href="#slapo.OrderedDict.items" title="Permalink to this definition"><span>¶</span></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.OrderedDict.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">an</span> <span class="pre">object</span> <span class="pre">providing</span> <span class="pre">a</span> <span class="pre">view</span> <span class="pre">on</span> <span class="pre">D's</span> <span class="pre">values</span></span></span><a class="headerlink" href="#slapo.OrderedDict.values" title="Permalink to this definition"><span>¶</span></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.OrderedDict.pop">
<span class="sig-name descname"><span class="pre">pop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="optional">]</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">v,</span> <span class="pre">remove</span> <span class="pre">specified</span> <span class="pre">key</span> <span class="pre">and</span> <span class="pre">return</span> <span class="pre">the</span> <span class="pre">corresponding</span></span></span><a class="headerlink" href="#slapo.OrderedDict.pop" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>value.  If key is not found, d is returned if given, otherwise KeyError
is raised.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.OrderedDict.setdefault">
<span class="sig-name descname"><span class="pre">setdefault</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#slapo.OrderedDict.setdefault" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Insert key with a value of default if key is not in the dictionary.</p>
<p>Return the value for key if key is in the dictionary, else default.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.OrderedDict.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">a</span> <span class="pre">shallow</span> <span class="pre">copy</span> <span class="pre">of</span> <span class="pre">od</span></span></span><a class="headerlink" href="#slapo.OrderedDict.copy" title="Permalink to this definition"><span>¶</span></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.OrderedDict.fromkeys">
<span class="sig-name descname"><span class="pre">fromkeys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#slapo.OrderedDict.fromkeys" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Create a new ordered dictionary with keys from iterable and values set to value.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="slapo.Pattern">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">Pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/pattern.html#Pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Pattern" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.Pattern.forward" title="slapo.Pattern.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(*args)</p></td>
<td><p>Defines the computation performed at every call.</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="slapo.Pattern.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/pattern.html#Pattern.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Pattern.forward" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="slapo.ScheduleMetadata">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">ScheduleMetadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tie_weights=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_tags=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitives=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/schedule.html#ScheduleMetadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.ScheduleMetadata" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>The metadata of a schedule. It is used to store the metadata of
primitives and the top module mainly for 1) verification and
2) applying framework dialects. Note that when replacing a module,
the schedule metadata of the original module is NOT transferred to the
new schedule, because the new module may not have the same structure
as the original module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tie_weights</strong> (<em>dict</em><em>[</em><em>nn.Parameter</em><em>, </em><em>nn.Parameter</em><em>]</em>) – </p></li>
<li><p><strong>param_tags</strong> (<em>set</em><em>[</em><em>str</em><em>]</em>) – </p></li>
<li><p><strong>primitives</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.analyze_tie_weights">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">analyze_tie_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">top_mod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_pipeline_partitioned</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/pipeline.html#analyze_tie_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.analyze_tie_weights" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Analyze if there is any tie weights (two weights in different module
share the same memory) partitioned into different pipeline stages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>top_mod</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.0)"><em>torch.nn.Module</em></a>) – The top-level module. This should be a top pipeline module, so
1) it should already be traced and partitioned, and
2) it should have a number of submodules that matches pipeline stages.</p></li>
<li><p><strong>is_pipeline_partitioned</strong> (<em>bool</em>) – Whether the module is partitioned for pipeline or not. If not,
then all tie weights will have stage ID 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>tie_groups</strong> – Mapping from the nn.Parameter object to the set of parameter names
that are tied to it. The set of parameter names is a tuple of
(parameter name, stage ID). The stage ID is 0 if the module is not
partitioned for pipeline.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[int, Set[Tuple[str, int]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.consolidate_model">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">consolidate_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_init_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/build.html#consolidate_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.consolidate_model" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Consolidate the model weights.
FIXME: When pipeline is enabled, this function only supports DeepSpeed
runtime because it relies on DeepSpeed topology. We should use dialects
in this function to make it general applicable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sch</strong> (<a class="reference internal" href="schedule.html#slapo.schedule.Schedule" title="slapo.schedule.Schedule"><em>Schedule</em></a>) – </p></li>
<li><p><strong>target</strong> (<em>str</em>) – </p></li>
<li><p><strong>param_init_fn</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>[</em><em>[</em><em>nn.Module</em><em>]</em><em>, </em><em>None</em><em>]</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.create_schedule">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">create_schedule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/schedule.html#create_schedule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.create_schedule" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Create a schedule for the given module and preserve the module hierarchy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> (<em>nn.Module</em>) – The root module to create the schedule for.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The name of the module.</p></li>
<li><p><strong>path</strong> (<em>str</em>) – The path from the top module.</p></li>
<li><p><strong>parent</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="schedule.html#slapo.schedule.Schedule" title="slapo.schedule.Schedule"><em>Schedule</em></a><em>]</em>) – The parent schedule. None if the module is the top module.</p></li>
<li><p><strong>group</strong> (<em>Optional</em><em>[</em><em>dist.ProcessGroup</em><em>]</em>) – The process group for the module. If None, use all available devices.</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments for the schedule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The schedule for the module.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="schedule.html#slapo.schedule.Schedule" title="slapo.schedule.Schedule">Schedule</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.dataclass">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">dataclass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unsafe_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dataclasses.html#dataclass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.dataclass" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Returns the same class as was passed in, with dunder methods
added based on the fields defined in the class.</p>
<p>Examines PEP 526 __annotations__ to determine fields.</p>
<p>If init is true, an __init__() method is added to the class. If
repr is true, a __repr__() method is added. If order is true, rich
comparison dunder methods are added. If unsafe_hash is true, a
__hash__() method function is added. If frozen is true, fields may
not be assigned to after instance creation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.field">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repr=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hash=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compare=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dataclasses.html#field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.field" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Return an object to identify dataclass fields.</p>
<p>default is the default value of the field.  default_factory is a
0-argument function called to initialize a field’s value.  If init
is True, the field will be a parameter to the class’s __init__()
function.  If repr is True, the field will be included in the
object’s repr().  If hash is True, the field will be included in
the object’s hash().  If compare is True, the field will be used
in comparison functions.  metadata, if specified, must be a
mapping which is stored but not otherwise examined by dataclass.</p>
<p>It is an error to specify both default and default_factory.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.get_cuda_rng_tracker">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">get_cuda_rng_tracker</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/random.html#get_cuda_rng_tracker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.get_cuda_rng_tracker" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Get cuda rng tracker.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.get_dialect_cls">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">get_dialect_cls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/framework_dialect/registry.html#get_dialect_cls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.get_dialect_cls" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Get the framework dialect class.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.init_target_engine">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">init_target_engine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/build.html#init_target_engine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.init_target_engine" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Initialize the runtime engine for a specific target framework.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.is_module_list">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">is_module_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/utils/common.html#is_module_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.is_module_list" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>A module list will become nn.Module or fx.GraphModule after tracing,
but we still want to treat it as a module list in the schedule.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.list_primitives">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">list_primitives</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/schedule.html#list_primitives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.list_primitives" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>List all available schedule primitives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name_only</strong> (<em>bool</em>) – If True, only return the name of the primitives. Otherwise, return the
primitive class.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If name_only, return a list of all available schedule primitives;
otherwise return a dictionary mapping the name of the primitive to the
primitive class.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[list[str], dict[str, Primitive]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="slapo.partial">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">partial</span></span><a class="reference internal" href="../_modules/functools.html#partial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.partial" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>partial(func, <a href="#id5"><span class="problematic" id="id6">*</span></a>args, <a href="#id7"><span class="problematic" id="id8">**</span></a>keywords) - new function with partial application
of the given arguments and keywords.</p>
<p><strong>Attributes:</strong></p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.partial.args" title="slapo.partial.args"><code class="xref py py-obj docutils literal notranslate"><span class="pre">args</span></code></a></p></td>
<td><p>tuple of arguments to future partial calls</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.partial.func" title="slapo.partial.func"><code class="xref py py-obj docutils literal notranslate"><span class="pre">func</span></code></a></p></td>
<td><p>function object to use in future partial calls</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.partial.keywords" title="slapo.partial.keywords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">keywords</span></code></a></p></td>
<td><p>dictionary of keyword arguments to future partial calls</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="slapo.partial.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#slapo.partial.args" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>tuple of arguments to future partial calls</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="slapo.partial.func">
<span class="sig-name descname"><span class="pre">func</span></span><a class="headerlink" href="#slapo.partial.func" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>function object to use in future partial calls</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="slapo.partial.keywords">
<span class="sig-name descname"><span class="pre">keywords</span></span><a class="headerlink" href="#slapo.partial.keywords" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>dictionary of keyword arguments to future partial calls</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.trace">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/tracer.html#trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.trace" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Traces a model to a GraphModule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>nn.Module</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.trace_module">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">trace_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#slapo.trace_module" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Traces a model to a GraphModule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>nn.Module</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.is_random_seed_set">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">is_random_seed_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/random.html#is_random_seed_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.is_random_seed_set" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Check if random seed is set.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.checkpoint">
<span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_reentrant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/checkpoint.html#checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.checkpoint" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Checkpoint a model or part of the model. See PyTorch checkpoint
for details about behaviors and arguments. The only difference is
when the random seed is set by Slapo, the checkpoint function will
also track the random states and restore them properly.</p>
<p>TODO: The implementation in Megatron-LM has a mode to distribute
the saved activations across model parallel groups to further reduce
the memory footprint. This is not implemented here yet.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="slapo.Verify">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">slapo.</span></span><span class="sig-name descname"><span class="pre">Verify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/verify.html#Verify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.Verify" title="Permalink to this definition"><span>¶</span></a></dt>
<dd></dd></dl>

</div>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Python API</p>
      </div>
    </a>
    <a class="right-next"
       href="schedule.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">slapo.schedule</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Amazon
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023, Amazon.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>