Search.setIndex({docnames:["gallery/attention-single-gpu","gallery/index","gallery/mlp-multi-gpu","gallery/quick-start","gallery/sg_execution_times","genindex","index","python_api/framework_dialect/deepspeed/engine","python_api/framework_dialect/deepspeed/index","python_api/framework_dialect/deepspeed/pipeline","python_api/framework_dialect/index","python_api/framework_dialect/registry","python_api/index","python_api/initialization","python_api/model_schedule/api","python_api/model_schedule/index","python_api/op/attention","python_api/op/bias_gelu","python_api/op/cross_entropy","python_api/op/dropout","python_api/op/index","python_api/op/linear","python_api/op/mlp","python_api/pattern","python_api/pipeline","python_api/random","python_api/root","python_api/schedule","python_api/tracer","scripts/README","setup/index"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":5,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["gallery/attention-single-gpu.rst","gallery/index.rst","gallery/mlp-multi-gpu.rst","gallery/quick-start.rst","gallery/sg_execution_times.rst","genindex.rst","index.rst","python_api/framework_dialect/deepspeed/engine.rst","python_api/framework_dialect/deepspeed/index.rst","python_api/framework_dialect/deepspeed/pipeline.rst","python_api/framework_dialect/index.rst","python_api/framework_dialect/registry.rst","python_api/index.rst","python_api/initialization.rst","python_api/model_schedule/api.rst","python_api/model_schedule/index.rst","python_api/op/attention.rst","python_api/op/bias_gelu.rst","python_api/op/cross_entropy.rst","python_api/op/dropout.rst","python_api/op/index.rst","python_api/op/linear.rst","python_api/op/mlp.rst","python_api/pattern.rst","python_api/pipeline.rst","python_api/random.rst","python_api/root.rst","python_api/schedule.rst","python_api/tracer.rst","scripts/README.rst","setup/index.rst"],objects:{"":[[26,0,0,"-","slapo"]],"slapo.Database":[[26,2,1,"","commit"],[26,2,1,"","load"]],"slapo.LinearWithSeparateBias":[[26,2,1,"","forward"]],"slapo.ModulePattern":[[26,2,1,"","forward"]],"slapo.OrderedDict":[[26,2,1,"","clear"],[26,2,1,"","copy"],[26,2,1,"","fromkeys"],[26,2,1,"","items"],[26,2,1,"","keys"],[26,2,1,"","move_to_end"],[26,2,1,"","pop"],[26,2,1,"","popitem"],[26,2,1,"","setdefault"],[26,2,1,"","update"],[26,2,1,"","values"]],"slapo.Pattern":[[26,2,1,"","forward"]],"slapo.Space":[[26,2,1,"","cfg_dict_to_str"],[26,2,1,"","clone"],[26,2,1,"","create_symbol"],[26,2,1,"","log_space"],[26,2,1,"","next"],[26,2,1,"","reset"],[26,2,1,"","to_dict"]],"slapo.Symbol":[[26,2,1,"","add"],[26,2,1,"","fix_at"],[26,2,1,"","is_fixed"]],"slapo.framework_dialect":[[11,0,0,"-","registry"]],"slapo.framework_dialect.deepspeed":[[7,0,0,"-","engine"],[9,0,0,"-","pipeline"]],"slapo.framework_dialect.deepspeed.engine":[[7,4,1,"","init_ds_engine"]],"slapo.framework_dialect.deepspeed.pipeline":[[9,1,1,"","DeepSpeedPipeStageWrapper"],[9,1,1,"","WrappedTypeCode"],[9,4,1,"","analyze_tie_ranks"],[9,4,1,"","decode_metadata"],[9,4,1,"","deepspeed_pipe_engine"],[9,4,1,"","encode_metadata"],[9,4,1,"","flat_and_name_tensor_list"],[9,4,1,"","flatten"],[9,4,1,"","get_simple_nested_list_str"],[9,4,1,"","unflatten"]],"slapo.framework_dialect.deepspeed.pipeline.DeepSpeedPipeStageWrapper":[[9,2,1,"","forward"]],"slapo.framework_dialect.registry":[[11,4,1,"","get_all_dialects"],[11,4,1,"","get_dialect_cls"],[11,4,1,"","register_framework_dialect"]],"slapo.initialization":[[13,4,1,"","init_empty_weights"],[13,4,1,"","init_on_device"]],"slapo.model_schedule":[[14,0,0,"-","api"]],"slapo.model_schedule.api":[[14,4,1,"","apply_schedule"]],"slapo.op":[[16,0,0,"-","attention"],[17,0,0,"-","bias_gelu"],[18,0,0,"-","cross_entropy"],[19,0,0,"-","dropout"],[21,0,0,"-","linear"],[22,0,0,"-","mlp"]],"slapo.op.attention":[[16,1,1,"","AttentionOpWithRNG"],[16,1,1,"","FlashAttention"],[16,1,1,"","FlashAttentionOp"],[16,4,1,"","flash_attn_ref"],[16,4,1,"","get_xfoemers_attn_op_by_name"],[16,4,1,"","validate_sm_version"],[16,4,1,"","warning_once"],[16,4,1,"","xformers_ref"]],"slapo.op.attention.AttentionOpWithRNG":[[16,2,1,"","forward"]],"slapo.op.attention.FlashAttention":[[16,2,1,"","forward"],[16,2,1,"","reshape_for_scores"]],"slapo.op.attention.FlashAttentionOp":[[16,2,1,"","forward"]],"slapo.op.bias_gelu":[[17,1,1,"","BiasGeLUFunction"],[17,1,1,"","FusedBiasGELU"],[17,1,1,"","FusedBiasNewGELU"],[17,4,1,"","new_gelu"]],"slapo.op.bias_gelu.BiasGeLUFunction":[[17,2,1,"","backward"],[17,2,1,"","forward"]],"slapo.op.bias_gelu.FusedBiasGELU":[[17,2,1,"","forward"]],"slapo.op.bias_gelu.FusedBiasNewGELU":[[17,2,1,"","forward"]],"slapo.op.cross_entropy":[[18,1,1,"","ParallelCrossEntropy"],[18,4,1,"","vocab_parallel_cross_entropy"]],"slapo.op.cross_entropy.ParallelCrossEntropy":[[18,2,1,"","forward"]],"slapo.op.dropout":[[19,1,1,"","DropoutWithTensorParallel"]],"slapo.op.dropout.DropoutWithTensorParallel":[[19,2,1,"","forward"]],"slapo.op.linear":[[21,1,1,"","FusedQKV"],[21,1,1,"","LinearWithSeparateBias"]],"slapo.op.linear.FusedQKV":[[21,2,1,"","forward"]],"slapo.op.linear.LinearWithSeparateBias":[[21,2,1,"","forward"]],"slapo.op.mlp":[[22,1,1,"","FusedMLP"]],"slapo.op.mlp.FusedMLP":[[22,2,1,"","forward"]],"slapo.partial":[[26,3,1,"","args"],[26,3,1,"","func"],[26,3,1,"","keywords"]],"slapo.pattern":[[23,1,1,"","ModulePattern"],[23,1,1,"","Pattern"]],"slapo.pattern.ModulePattern":[[23,2,1,"","forward"]],"slapo.pattern.Pattern":[[23,2,1,"","forward"]],"slapo.pipeline":[[24,4,1,"","analyze_tie_weights"]],"slapo.random":[[25,1,1,"","CudaRNGStatesTracker"],[25,4,1,"","get_cuda_rng_tracker"],[25,4,1,"","is_random_seed_set"],[25,4,1,"","model_parallel_cuda_manual_seed"],[25,4,1,"","set_random_seed"]],"slapo.random.CudaRNGStatesTracker":[[25,2,1,"","add"],[25,2,1,"","fork"],[25,2,1,"","get_states"],[25,2,1,"","reset"],[25,2,1,"","set_states"]],"slapo.schedule":[[27,1,1,"","DictWithValidation"],[27,1,1,"","Schedule"],[27,1,1,"","ScheduleMetadata"],[27,1,1,"","SubgraphWrapper"],[27,4,1,"","consolidate_model"],[27,4,1,"","init_target_engine"],[27,4,1,"","register_primitive"]],"slapo.schedule.Schedule":[[27,2,1,"","find"],[27,2,1,"","find_node"],[27,2,1,"","find_subgraph"],[27,2,1,"","trace_for_pipeline"]],"slapo.schedule.SubgraphWrapper":[[27,2,1,"","forward"]],"slapo.tracer":[[28,4,1,"","trace"]],slapo:[[26,1,1,"","Database"],[26,1,1,"","DictWithValidation"],[26,3,1,"","FunctionType"],[26,1,1,"","LinearWithSeparateBias"],[26,1,1,"","ModulePattern"],[26,1,1,"","OrderedDict"],[26,1,1,"","Pattern"],[26,1,1,"","ScheduleMetadata"],[26,1,1,"","Space"],[26,1,1,"","Symbol"],[26,4,1,"","all_gather_forward_output"],[26,4,1,"","analyze_tie_weights"],[26,4,1,"","checkpoint"],[26,4,1,"","checkpoint_module"],[26,4,1,"","consolidate_model"],[26,4,1,"","dataclass"],[26,4,1,"","field"],[26,4,1,"","get_cuda_rng_tracker"],[26,4,1,"","get_dialect_cls"],[26,4,1,"","get_logger"],[26,4,1,"","get_output_type_after_sharding"],[26,4,1,"","init_empty_weights"],[26,4,1,"","init_target_engine"],[13,0,0,"-","initialization"],[26,4,1,"","is_random_seed_set"],[26,1,1,"","partial"],[23,0,0,"-","pattern"],[24,0,0,"-","pipeline"],[25,0,0,"-","random"],[26,4,1,"","reduce_backward_grad"],[26,4,1,"","reduce_forward_output"],[26,4,1,"","reduce_scatter_forward_output"],[26,4,1,"","register_primitive"],[26,4,1,"","scatter_forward_output"],[27,0,0,"-","schedule"],[26,4,1,"","set_random_seed"],[26,4,1,"","trace"],[26,4,1,"","trace_module"],[28,0,0,"-","tracer"],[26,4,1,"","transfer_hooks"],[26,4,1,"","transfer_hooks_for_fusion"]]},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","attribute","Python attribute"],"4":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:attribute","4":"py:function"},terms:{"0":[0,2,3,4,9,16,17,18,19,24,26],"00":[3,4],"001":3,"05":0,"07":4,"074":[2,4],"1":[0,2,3,9,16,18,24,26,27],"10":3,"100":3,"1024":[0,2,3],"11":3,"12":3,"124kb":3,"125":[0,4],"13":3,"14":3,"15":3,"16":[0,3],"17":3,"18":3,"181":[0,2],"19":3,"1e":[0,3],"2":[0,2,3,24,26,27],"20":[3,26],"2013":[25,26],"21":3,"22":3,"23":3,"3":[0,3],"30522":3,"3072":0,"3676bd2":16,"4":3,"4096":3,"464":[3,4],"48a77cc":16,"5":[3,19],"512":3,"526":26,"571":3,"6":3,"663":4,"7":3,"8":[0,2,3],"9":3,"boolean":17,"break":2,"case":[0,19,26],"class":[0,2,9,11,16,17,18,19,21,22,23,25,26,27],"default":[0,2,3,18,25,26],"do":[0,2,16,25,26],"final":[0,2,26,27],"float":[16,19],"function":[0,2,3,7,9,11,13,14,16,17,18,19,21,22,23,24,25,26,27,28],"import":[0,2,3,30],"int":[9,16,21,24,25,26],"long":3,"new":[0,17,26],"return":[0,2,3,9,16,17,19,21,23,24,25,26,27],"static":[0,2,17,26,27],"super":[0,2],"throw":26,"true":[0,2,3,13,16,17,21,26],"try":[0,27],"while":[0,9,13,16,17,18,19,21,22,23,26,27],A:[1,2,4,6,9,13,16,22,26,27],As:[0,2],By:[0,2,3],For:[0,9,25,26,27,30],If:[0,2,3,16,17,24,26,27,30],In:[0,19,26],It:[0,6,17,26],The:[0,2,3,9,16,17,19,24,26,27,30],Then:0,To:[0,2,30],_:[0,2,3],__annotations__:26,__hash__:26,__init__:[0,2,26],__repr__:26,_c:[0,2],_check:[0,2],_init_weight:3,_missing_typ:26,_nn:[0,2],_proj:0,_stacklevel:0,a_1:2,a_2:2,abil:27,about:[2,26],abov:[0,16],absolut:16,accept:[0,17],accordingli:2,achiev:0,across:[18,25,26],activ:[2,17,26],actual:2,ad:[0,26],adamw:3,add:[0,2,3,25,26],add_1:0,add_2:0,addit:[0,2],address:6,affect:0,after:[0,2,3,9,25,26],afterward:[9,16,17,18,19,21,22,23,26,27],again:0,alia:[17,26],all:[0,9,11,13,16,17,18,19,21,22,23,24,26,27],all_gather_forward_output:26,all_reduc:2,allow_non:[11,26],along:[2,26],alreadi:[0,2,3,24,26],also:[0,2,3,13,17,25,26,30],although:[9,16,17,18,19,21,22,23,26,27],alwai:[0,2],among:25,an:[0,2,3,13,16,17,26],analyz:[9,24,26],analyze_tie_rank:9,analyze_tie_weight:[24,26],ani:[0,17,24,26,27,28],annot:[0,2,26,27],anoth:[0,2],aot:17,apart:0,api:[0,3,6,15,27],appli:[0,3,14,16],applic:[26,27],apply_and_build_schedul:3,apply_causal_mask:[0,16],apply_schedul:[3,14],approach:30,approxim:2,ar:[0,2,9,13,17,18,21,24,25,26],arbitrari:17,arg:[9,17,23,26],argument:[0,9,17,21,26,27],assign:[9,25,26],attach:[0,26],attent:[1,3,4,6,20],attention_mask:[0,3,16],attention_output:0,attentionopwithrng:16,attn:0,attn_bia:16,attn_nam:16,attn_op_nam:[0,16],attn_pdrop:16,attn_prob:0,attn_sch:0,attn_scor:0,attribut:[0,2,17,26,27],auto:16,autoconfig:3,automat:17,avail:[13,26],awslab:30,axi:[2,26],b:[2,3,26],b_1:2,b_2:2,back:16,backend:[0,2],backward:[2,3,17],base:[0,2,25,26],basic:[0,2,25],basin:2,batch_siz:[0,16,18],becaus:[26,27],becom:[0,2,26],been:[0,26],befor:[2,26],begin:[2,26],behavior:26,belong:27,below:[0,2],bert:3,bertattent:3,bertembed:3,bertencod:3,bertintermedi:3,bertlay:3,bertlmheadmodel:3,bertlmpredictionhead:3,bertmodel:3,bertonlymlmhead:3,bertoutput:3,bertpredictionheadtransform:3,bertselfattent:3,bertselfoutput:3,better:0,between:6,bf16:[3,16],bia:[0,2,3,16,17,21,22,26,27],bias_ge_lu_0:2,bias_gelu:20,biasgelu:[2,17],biasgelu_0:2,biasgelufunct:17,blow:[13,26],bmatrix:2,bodi:[0,2],bool:[13,16,19,21,24,26],both:[0,2,26],bs:[0,3],buffer:[13,26],build:3,bwd_post:2,c:[0,30],call:[0,2,3,9,16,17,18,19,21,22,23,25,26,27],call_modul:[0,27],callabl:[26,27],can:[0,2,3,16,17,25,27,30],candid:26,cannot:26,care:[2,9,16,17,18,19,21,22,23,26,27],cast:16,causal:16,cd:30,cdot:0,cfg_dict:26,cfg_dict_to_str:26,chang:[0,2,6,16,26,30],check:[0,2,16,25,26],checkpoint:[3,26],checkpoint_modul:26,choos:0,ckpt_ratio:3,cl:[3,26],clear:26,clearli:0,click:[0,2,3],clone:[3,26,30],cls_type:[11,26],code:[0,2,3,9],codebas:30,column:2,com:[16,30],come:2,command:30,commit:[16,26],common:[0,6],commun:9,compar:[0,26],comparison:26,compat:[17,25],compil:[0,2],complex:2,compon:2,comput:[0,2,9,16,17,18,19,21,22,23,26,27],concrete_arg:0,conduct:[0,3],config:[3,9,26],configur:3,connect:0,consequenti:0,consid:2,consist:[0,2],consolid:[26,27],consolidate_model:[26,27],constraint:[0,27],consum:0,contain:27,context:[13,17,26],contigu:0,control:0,convent:2,converg:19,convert:[6,26],copi:[16,17,25,26],core:0,core_attn_subgraph:0,coreattent:[0,16],correct:[16,18],correctli:[0,2],correspond:[0,2,17,26],cover:[0,2],cpu:2,creat:[3,13,26,27],create_schedul:[0,2],create_symbol:26,creation:26,cross:[16,18],cross_entropi:20,ctx:17,cuda:[0,3,16,25,26],cudarngstatestrack:25,current:[0,17],custom:[3,26],cut:27,cutlass:[0,16],d:[16,26],d_k:0,data:[2,3,9,17,25,26],databas:26,dataclass:26,dataflow:[0,2,27],db:26,db_file_nam:26,debug:[0,2,26],debugg:0,decod:[3,9],decode_metadata:9,decompos:[0,2],decoupl:6,deep:0,deepspe:[10,26,27],deepspeed_pipe_engin:9,deepspeedpipestagewrapp:9,def:[0,2,3],default_factori:26,defin:[0,2,9,16,17,18,19,21,22,23,26,27],definit:6,defint:3,demonstr:0,dens:[0,3],dense_bia:0,dense_weight:0,depict:0,detail:[0,2,3,26],determin:[2,26],dev:30,develop:30,devic:[1,3,4,6,9,13,17,19,21,26],dialect:[11,26,27],dict:[9,24,26,27,28],dictionari:[25,26],dictwithvalid:[26,27],differ:[0,2,19,24,25,26,27],differenti:17,dim:[0,26],dimens:[0,2,18,26],direct:25,directli:[0,3,6,17,27,30],dispatch:[0,27],dist:[2,27],distribut:[2,18,26],doc:[26,27],documetn:16,doe:[0,26],doesn:[0,2],download:[0,2,3],dp_rank:[25,26],dropout:[0,3,16,20,25],dropout_mask:16,dropout_p:16,dropoutwithtensorparallel:19,dtype:[0,3,17,21,26],due:[19,26],dunder:26,duplic:26,dure:[2,17],e:[0,17,26,30],each:[0,2,9,17,19],easi:0,easier:27,easiest:30,easili:[0,2],effect:30,effici:[0,6,16,25],either:[0,2,17,26],element:[0,26],elementwise_affin:[0,3],els:26,embed:[3,16],emploi:0,empti:[0,2,13,26],enabl:[2,6,13,26,27],encod:[3,9],encode_metadata:9,encoder_attention_mask:16,encoder_hidden_st:16,encount:16,end:[2,26],enforc:17,engin:[8,9,10,26,27],enhanc:0,enough:2,entropi:18,env:2,ep:[0,3],eq:26,equival:[16,17],error:[16,26],estim:16,etc:16,even:0,everi:[9,16,17,18,19,21,22,23,26,27],exactli:0,examin:26,exampl:[0,2,3,9,25,26],execut:[0,4,6],exist:26,exit:25,expect:2,explicitli:[0,2,3],express:[0,2,27],f52868287ca9bd3ac1598dad6ce818358c1beafc:16,f:[0,2,3,26],facebookresearch:16,factor:18,factori:[26,27],fals:[0,2,3,11,13,16,19,26,27],field:26,fifo:26,file:[4,26],find:[0,2,27],find_nod:27,find_subgraph:27,finish:0,first:[0,2,3,17,26],five:0,fix:26,fix_at:26,fixm:[26,27],flag:[0,2],flash:[0,3,16],flash_attention_op_0:0,flash_attn:0,flash_attn_ref:16,flashattent:16,flashattentionop:[0,16],flashattentionop_0:0,flashattentiontriton:16,flat:9,flat_and_name_tensor_list:9,flatten:[0,2,9],flexibl:2,float16:3,floattensor:16,follow:[0,2,16,17,26,30],footprint:26,fork:25,format:[9,27],former:[9,16,17,18,19,21,22,23,26,27],formula:17,forward:[0,2,9,16,17,18,19,21,22,23,26,27],found:[3,26],fp16:[3,9,16],fp32:16,frac:0,framework:[0,2,11,24,26,27],framework_dialect:12,from:[0,3,6,9,16,17,21,24,26,27,30],from_pretrain:3,fromkei:26,frozen:26,full:[0,2,3],func:26,functiontyp:[26,27],further:26,fuse:[0,2,3,17,22,26],fused_layer_norm_0:0,fused_linear:0,fused_qkv:[0,16],fused_qkv_0:0,fusedbiasgelu:17,fusedbiasnewgelu:17,fusedlayernorm:0,fusedlayernorm_0:0,fusedmlp:22,fusedqkv:[0,21],fusedqkv_0:0,fusion:[0,26],futur:26,fuzzi:[0,2],fwd_post:2,fwd_pre:26,fx:[0,9,27],g:[0,17],galleri:[0,2,3,4],gather:26,gelu:[2,17,22],geluactiv:3,gemm:0,gener:[0,1,2,3,26,27],get:[0,11,16,25,26],get_all_dialect:11,get_cuda_rng_track:[25,26],get_dialect_cl:[11,26],get_logg:26,get_output_type_after_shard:26,get_rank:2,get_simple_nested_list_str:9,get_stat:25,get_world_s:2,get_xfoemers_attn_op_by_nam:16,getattr_1:0,getattr_2:0,getattr_3:0,getattr_4:0,getitem:0,getitem_1:0,getitem_2:0,getitem_3:0,getitem_6:0,getitem_7:0,getitem_8:0,git:30,github:[16,30],give:0,given:[9,17,26,27],gloo:2,gpt:2,gpu:[0,2,4,9,25],grab:0,grad:17,grad_output:17,gradient:[17,26],gradual:0,graph:[0,2,27],graph_modul:[0,2],graphmodul:[0,2,9,26,28],greatli:0,group:[18,19,25,26,27],guid:[0,2,3],ha:[0,16,17,19,26],half:2,handl:0,hash:[16,26],have:[0,2,3,17,19,24,25,26,30],head:[0,16],head_dim:16,head_mask:16,help:0,helper:9,here:[0,2,3,26],hf:16,hidden:0,hidden_s:[0,2,16,18,21,22],hidden_st:[0,16,21,22],hierarch:[0,2],hierarchi:0,high:16,hold:2,hook:[9,16,17,18,19,21,22,23,26,27],hook_typ:26,how:[0,2],howev:26,hs:0,http:[16,30],hub:3,huggingfac:[3,16,17],hurt:19,id:[18,24,26],idea:0,ident:0,identifi:26,idx:26,ignor:[9,16,17,18,19,21,22,23,26,27],implement:[0,2,3,16,21,26],implicitli:0,in_featur:[0,2,3,21,26],includ:[0,2,9,26,27],include_buff:[13,26],incorpor:0,independ:0,index:[6,26],infer:26,info:[0,2],inform:9,init:26,init_ds_engin:7,init_empty_weight:[13,26],init_on_devic:13,init_target_engin:[26,27],init_weight:[0,2,3],initi:[2,3,7,12,25,26,27],inject:3,inner:27,inp:[17,26],inplac:[0,3,19],input:[0,2,3,16,17,19,21,25,26],input_id:3,input_tensor:0,insert:[2,26],insid:27,instal:[0,2,3,6],instanc:[0,2,9,16,17,18,19,21,22,23,26,27],instanti:[0,2],instead:[0,2,9,16,17,18,19,21,22,23,26,27],intend:17,inter:9,intermedi:3,intermediate_act_fn:3,intermediate_s:22,invok:[26,27],ipynb:[0,2,3],ir:0,is_decod:3,is_fix:26,is_pipeline_partit:[24,26],is_random_seed_set:[25,26],item:[3,9,26],iter:26,its:[0,2,3,26],itself:6,jfc4050:16,jit:[0,2],json:3,jupyt:[0,2,3],just:[0,2,13,17,25,26],jvp:17,k:[0,16,26],k_proj:0,keep:[0,26],kei:[0,3,26],kernel:[0,2,3,16,17,22],key_lay:16,key_padding_mask:16,keyerror:26,keyword:[9,26],kwarg:[7,9,17,26,27,28],label:[3,18],label_smooth:18,lack:26,lambda:27,languag:6,lanuch:2,larg:[3,6],last:26,later:[0,2,25,26,27],latter:[0,9,16,17,18,19,21,22,23,26,27],launch:0,layer:[2,3],layer_norm:0,layer_past:16,layernorm:[0,3],learn:0,left:[0,2],len:9,let:0,level:[0,2,24,26,27],leverag:[0,2,3],lib:[0,2],librari:0,lifo:26,like:[2,3,26],limit:16,line:[0,2],linear1:2,linear1_bia:2,linear1_weight:2,linear2:2,linear:[2,3,20,26],linearwithseparatebia:[0,2,21,26],list:[0,9,26,27],live:9,lm:[2,17,26],ln_pattern:0,ln_subgraph:0,load:[3,26],local:[0,2],log:[16,26],log_spac:26,logger:26,logit:18,loop:3,loss:[3,18],loss_fn:9,low:2,lower:16,lr:3,lve:3,machin:2,made:0,mai:[0,19,26],main:3,mainli:[9,16],maintain:9,make:[0,2,3,9,19,22,26,27],manag:[13,25,26],mani:17,manual_se:25,map:[24,26],mask:[16,19],match:[0,2,24,26,27],math:16,mathrm:0,matmul:0,matmul_1:0,matrix:[0,2],max_sm:16,maximum:16,mb:4,mean:[2,19,25,26],megatron:[2,17,26],memori:[24,26],merg:0,messag:16,meta:[13,26],metadata:[9,26],metadata_str:9,method:[9,16,17,18,19,21,22,23,25,26,27],micro_batch_s:18,middl:26,min_sm:16,minimum:16,minut:[0,2,3],mlp:[1,4,6,20],mod:[0,2,9,27],mode:[2,17,26],model:[6,7,9,13,14,25,26,27,28],model_config:3,model_parallel_cuda_manual_se:25,model_schedul:3,modifi:[21,26],modul:[1,3,4,6,9,16,17,18,19,21,22,23,24,26,27,28],modulelist:3,modulepattern:[23,26],more:[0,2],most:[0,2,27],move:26,move_to_end:26,msg:16,much:0,multi:[1,4,6],multipl:[0,2],multipli:2,must:[17,18,26],n_head:0,name:[0,2,9,16,23,24,25,26,27],nativ:16,native_flash_attn:16,native_xform:[0,16],nccl:2,necessari:[0,2],need:[0,2,9,16,17,18,19,21,22,23,26,27],need_dist:[26,27],needs_input_grad:17,nest:9,new_gelu:17,new_mod:26,new_shap:0,next:[0,26],nhead:16,nn:[0,2,3,9,21,24,26,27,28],node:[0,2,26,27],non:[0,2,17,25],none:[0,2,9,16,17,18,19,21,23,25,26,27],norm:0,note:[9,16,26],notebook:[0,2,3],noth:26,notic:[0,2],num_attention_head:16,num_head:21,number:[0,2,17,24,26],numer:16,nvfuser:[0,2],nvidia:0,object:[24,26,27],obtain:0,od:26,old:26,old_mod:26,onc:16,one:[0,2,9,16,17,18,19,21,22,23,26,27],ones:3,onli:[0,2,16,26,27],op:[0,12,26],oper:[0,3,16,17,25,26],opt_model:[0,2,3],optim:[1,4,6],option:[16,25,26,27],order:[16,26],ordereddict:26,organ:16,orig_act:22,origin:[0,2,9,19,25,26],original_nam:[0,2],other:[0,2,17,26],otherwis:[19,26,27],our:[0,25],out:[0,2],out_featur:[0,2,3,21,26],outdens:16,outer:27,output:[0,2,3,9,16,17,18,26,30],output_attent:16,output_proj:16,over:0,overhead:0,overridden:[9,16,17,18,19,21,22,23,26,27],p:[0,3,16,19],packag:[0,2,3,30],padding_idx:3,pair:26,parallel:[3,18,19,25,26],parallelcrossentropi:18,param:26,param_init_fn:[26,27],paramet:[0,3,9,13,16,18,19,21,24,25,26,27,28],parent:[26,27],part:[0,2,26],partial:[0,26],partit:[19,24,26],pass:[0,2,3,9,16,17,18,19,21,22,23,26,27],path:[9,27],pattern:[0,2,12,26,27],pattern_fn:27,pep:26,perceptron:2,perform:[0,2,3,9,16,17,18,19,21,22,23,25,26,27],permut:0,permute_1:0,permute_2:0,permute_for_scor:0,pip:30,pipelin:[8,10,12,25,26,27],pipeline_cutting_path:[26,27],pipelinemodul:9,pleas:[0,2,16,27],point:2,pointer:25,pop:26,popitem:26,posit:16,position_embed:3,pp_rank:[25,26],practic:0,predefin:[2,3],predict:3,prefix:3,present:26,preserv:[0,2],prev_weight:17,previou:2,previous:0,primit:[0,2,6,26,27],print:[0,2,3,9,26,27,30],print_read:[0,2],probabl:[0,16],process:[16,26],processgroup:[26,27],progress:[0,6],proj:0,proj_sch:0,project:16,properli:26,provid:[0,2,3,26,27,30],purpos:25,put:[13,26],py:[0,2,3,4],pypi:30,python3:[0,2],python:[0,2,3,6,30],pytorch:[0,2,6,16,26],q:[0,16],q_proj:0,qk:0,qkv_subgraph:0,queri:[0,3],query_lay:16,query_padding_mask:16,quick:[1,4,6],r:[0,17],rais:26,ram:[13,26],random:[12,19,26],rang:[3,18],rank:[2,9,18,25,26],ratio:3,re:26,readabl:0,realiti:0,realiz:2,reason:0,recip:[9,16,17,18,19,21,22,23,26,27],record:[26,27],recursivescriptmodul:[0,2],reduc:[0,26],reduce_backward_grad:26,reduce_forward_output:26,reduce_scatter_forward_output:26,refer:0,reflect:0,regex:27,regex_or_pattern_fn:27,region:[19,25],regist:[9,11,16,17,18,19,21,22,23,26,27],register_framework_dialect:11,register_primit:[26,27],registr:11,registri:10,regular:[0,27],relat:9,reli:[26,27],remain:0,rememb:26,remov:26,reorder:16,reorder_op:16,replac:[2,25],replai:[26,27],repr:26,repres:17,reproduc:[25,26],requir:[0,17],reset:[25,26],reshape_for_scor:16,reshaped_qkv:0,resid_pdrop:[16,22],residu:[0,27],restor:[9,26],result:[2,26],ret:9,retriev:17,reus:0,revers:9,rich:26,right:[0,2],rng:[25,26],row:2,run:[0,2,3,9,16,17,18,19,21,22,23,26,27,30],runtim:[26,27],s:[2,3,26],same:[0,16,19,21,24,25,26],satisfi:[0,27],save:[17,26],save_for_backward:17,save_for_forward:17,scale:16,scaled_dot_product:0,scatter:26,scatter_forward_output:26,sch:[0,2,3,26,27],sch_config:14,sch_metadata:9,schedul:[3,6,9,12,14,26],schedule_kei:14,schedulemetadata:[9,26,27],script:[0,2,3],seamlessli:0,second:[0,2,3],see:[0,2,26],seed:[19,25,26],self:[0,2,3,16],self_attn:0,self_output:0,selfattent:16,separ:[0,2],seq:0,seq_len:0,seq_length:3,seqlen_k:16,seqlen_q:16,sequenc:19,sequence_length:18,set:[0,6,24,25,26],set_random_se:[25,26],set_stat:25,setdefault:26,setup:2,sever:2,shallow:26,shape:[0,16],shard:[0,2,26,27],sharded_s:26,share:[24,26],should:[0,9,16,17,18,19,21,22,23,24,25,26,27],show:[0,2],shown:[0,2],signatur:16,silent:[9,16,17,18,19,21,22,23,26,27],simpl:26,simpler:0,simpli:0,sinc:[0,2,9,16,17,18,19,21,22,23,26,27],singl:[1,2,4,6],site:[0,2],size:[17,25,26],slapo:[0,2,12,30],slice:0,sm:16,small:0,smooth:18,so:[0,3,24,25,26,27],softmax:[0,16],softmax_scal:16,sourc:[0,2,3,7,9,11,13,14,16,17,18,19,21,22,23,24,25,26,27,28,30],space:26,special:16,specif:[26,27],specifi:[0,2,13,26,27],sphinx:[0,1,2,3],split:[0,18,26],sqrt:[0,16],squeez:0,stage:[9,24,26,27],stage_id:9,stage_id_2_arg_nam:9,stage_modul:9,standalon:3,start:[1,4,25],state:[0,25,26],statu:[26,27],step:3,still:[0,2,3],store:[17,26],str:[9,16,24,26,27,28],strategi:2,string:[9,26],structur:[0,9],sub:27,subclass:[9,16,17,18,19,21,22,23,26,27],subgraph:[0,2,26,27],subgraphwrapp:27,submodul:[0,24,26,27],subschedul:0,successfulli:30,suffix:9,support:[0,2,16,24,26,27],suppos:19,sure:[0,2,3,9,19],symbol:26,sync:[2,26],sync_op_or_fn:2,synchron:2,system:[0,2],t1:9,t2:9,t:[0,2,17],take:[0,9,16,17,18,19,21,22,23,26,27,30],tape:[26,27],target:[11,18,26,27],tension:6,tensor:[0,3,9,16,17,18,19,21,25,26],tensor_parallel_output_grad:26,test:16,thei:[2,17],them:[0,9,16,17,18,19,21,22,23,26,27],therefor:[13,26],thi:[0,2,3,9,13,16,17,18,19,21,22,23,24,25,26,27],thing:0,those:0,though:[0,17],three:0,through:[0,3,30],thu:[0,6],ti:[9,24,26],tie:[24,26],tie_group:[24,26],tie_weight:[26,27],tie_weight_group:9,time:[0,2,3],to_dict:26,todo:[26,27],togeth:0,token_type_embed:3,token_type_id:3,top:[0,24,26,27],top_mod:[24,26],topolog:[9,26,27],torch:[0,2,3,9,13,16,18,21,24,25,26],torchscript:[0,2],total:[0,2,3,4],total_stag:9,tp_rank:[25,26],trace:[0,2,24,26,27,28],trace_for_pipelin:27,trace_modul:26,tracer:[0,12],track:[25,26],tracker:[25,26],tradit:0,train:[0,3,6],training_script_arg:26,transfer:26,transfer_hook:26,transfer_hooks_for_fus:26,transform:[0,2,3,17],transform_act_fn:3,transpos:[0,2,16],transpose_for_scor:16,triangular:16,triton:[0,16],truediv:0,tunabl:26,tune:26,tupl:[16,17,24,26,27],tutori:[0,2],two:[0,2,24,25,26,30],type:[0,2,3,9,16,17,19,21,23,24,25,26,27],uncas:3,under:[13,26],unflatten:9,union:27,unsafe_hash:26,until:27,upcast:16,updat:26,update_space_fn:26,us:[0,2,3,6,9,13,16,17,19,22,25,26,27],usabl:6,use_cach:16,use_reentr:26,user:[0,2,3,6],userwarn:[0,2],usr:[0,2],usual:[0,2,3],v100:0,v:[0,16,26],v_proj:0,val:26,valid:16,validate_sm_vers:16,valu:[0,3,9,17,26],value_lay:16,verifi:30,version:16,vertic:0,view:[0,26],view_1:0,view_2:0,vjp:17,vocab:18,vocab_parallel_cross_entropi:18,vocab_parallel_logit:18,w:17,wa:26,wai:[0,30],walk:3,want:[0,2,3],warn:[0,2,16],warning_onc:16,we:[0,2,3,9,16,19,25,26,27,30],weight:[0,2,9,24,26,27],were:17,when:[13,16,18,26,27,30],where:[0,2],wherea:26,whether:[2,13,16,17,24,26,27],which:[0,2,13,19,26],whose:27,wise:0,within:[9,16,17,18,19,21,22,23,26,27],without:[6,9,16],word_embed:3,work:0,world_siz:[2,21],would:[13,26],wrap:[0,2,9,26,27],wrappedtypecod:9,wrapper:[16,22,24],write:[0,2],x:[0,2,16,21,26,27],xa:2,xa_1:2,xa_2:2,xformer:[0,16],xformers_ref:16,yet:26,you:[0,2,3,16,17,27,30]},titles:["Optimize Attention Module on A Single Device","Gallery","Optimize MLP Module on Multi-Device","Quick Start","Computation times","Index","Slapo Documentation","slapo.framework_dialect.deepspeed.engine","slapo.framework_dialect.deepspeed","slapo.framework_dialect.deepspeed.pipeline","slapo.framework_dialect","slapo.framework_dialect.registry","Python API","slapo.initialization","slapo.model_schedule.api","slapo.model_schedule","slapo.op.attention","slapo.op.bias_gelu","slapo.op.cross_entropy","slapo.op.dropout","slapo.op","slapo.op.linear","slapo.op.mlp","slapo.pattern","slapo.pipeline","slapo.random","slapo","slapo.schedule","slapo.tracer","Gallery","Installation"],titleterms:{A:0,api:[12,14],attent:[0,16],bias_gelu:17,build:[0,2],comput:4,creat:[0,2],cross_entropi:18,deepspe:[7,8,9],definit:[0,2],devic:[0,2],document:6,dot:0,dropout:19,engin:7,framework_dialect:[7,8,9,10,11],fusion:2,galleri:[1,29],get:6,index:5,initi:13,instal:30,layer:0,linear:[0,21],mlp:[2,22],model:[0,2,3],model_schedul:[14,15],modul:[0,2],multi:2,op:[16,17,18,19,20,21,22],oper:2,optim:[0,2,3],parallel:2,pattern:23,pipelin:[9,24],product:0,project:0,python:12,pytorch:3,qkv:0,quick:3,random:25,refer:6,registri:11,replac:0,scale:0,schedul:[0,2,27],selfattent:0,singl:0,slapo:[3,6,7,8,9,10,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],start:[3,6],submodul:[8,10,15,20],tensor:2,time:4,tracer:28,tutori:6}})