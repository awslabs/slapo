

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>slapo.random &#8212; Slapo Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'python_api/random';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="slapo.framework_dialect" href="framework_dialect/index.html" />
    <link rel="prev" title="slapo.tracer" href="tracer.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">Slapo Documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/quick-start.html">Quick Start</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../gallery/attention-single-gpu.html">Optimize Attention Module on A Single Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/mlp-multi-gpu.html">Optimize MLP Module on Multi-Device</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Python API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="root.html">slapo</a></li>
<li class="toctree-l2"><a class="reference internal" href="schedule.html">slapo.schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="initialization.html">slapo.initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="pattern.html">slapo.pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipeline.html">slapo.pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="tracer.html">slapo.tracer</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">slapo.random</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="framework_dialect/index.html">slapo.framework_dialect</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="framework_dialect/registry.html">slapo.framework_dialect.registry</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="framework_dialect/deepspeed/index.html">slapo.framework_dialect.deepspeed</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="framework_dialect/deepspeed/engine.html">slapo.framework_dialect.deepspeed.engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="framework_dialect/deepspeed/pipeline.html">slapo.framework_dialect.deepspeed.pipeline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="model_schedule/index.html">slapo.model_schedule</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="model_schedule/api.html">slapo.model_schedule.api</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="op/index.html">slapo.op</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="op/attention.html">slapo.op.attention</a></li>
<li class="toctree-l3"><a class="reference internal" href="op/cross_entropy.html">slapo.op.cross_entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="op/fused_bias.html">slapo.op.fused_bias</a></li>
<li class="toctree-l3"><a class="reference internal" href="op/linear.html">slapo.op.linear</a></li>
<li class="toctree-l3"><a class="reference internal" href="op/mlp.html">slapo.op.mlp</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/awslabs/slapo" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/python_api/random.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>slapo.random</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="section" id="module-slapo.random">
<span id="slapo-random"></span><h1>slapo.random<a class="headerlink" href="#module-slapo.random" title="Permalink to this headline"><span>¶</span></a></h1>
<p>Random seed and states management.</p>
<p><strong>Classes:</strong></p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.random.CudaRNGStatesTracker" title="slapo.random.CudaRNGStatesTracker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CudaRNGStatesTracker</span></code></a>()</p></td>
<td><p>Tracker for the cuda RNG states.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.random.get_cuda_rng_tracker" title="slapo.random.get_cuda_rng_tracker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_cuda_rng_tracker</span></code></a>()</p></td>
<td><p>Get cuda rng tracker.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.random.model_parallel_cuda_manual_seed" title="slapo.random.model_parallel_cuda_manual_seed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model_parallel_cuda_manual_seed</span></code></a>(seed, ...)</p></td>
<td><p>Initialize model parallel cuda seed.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.random.is_random_seed_set" title="slapo.random.is_random_seed_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_random_seed_set</span></code></a>()</p></td>
<td><p>Check if random seed is set.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.random.set_random_seed" title="slapo.random.set_random_seed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_random_seed</span></code></a>([seed, dp_rank, pp_rank, ...])</p></td>
<td><p>Set random seed for reproducibility.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="slapo.random.CudaRNGStatesTracker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">slapo.random.</span></span><span class="sig-name descname"><span class="pre">CudaRNGStatesTracker</span></span><a class="reference internal" href="../_modules/slapo/random.html#CudaRNGStatesTracker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.random.CudaRNGStatesTracker" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Tracker for the cuda RNG states.
Using the <cite>add</cite> method, a cuda rng state is initialized based on
the input <cite>seed</cite> and is assigned to <cite>name</cite>. Later, by forking the
rng state, we can perform operations and return to our starting
cuda state.</p>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.random.CudaRNGStatesTracker.reset" title="slapo.random.CudaRNGStatesTracker.reset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset</span></code></a>()</p></td>
<td><p>Set to the initial state (no tracker).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.random.CudaRNGStatesTracker.get_states" title="slapo.random.CudaRNGStatesTracker.get_states"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_states</span></code></a>()</p></td>
<td><p>Get rng states.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.random.CudaRNGStatesTracker.set_states" title="slapo.random.CudaRNGStatesTracker.set_states"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_states</span></code></a>(states)</p></td>
<td><p>Set the rng states.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#slapo.random.CudaRNGStatesTracker.add" title="slapo.random.CudaRNGStatesTracker.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add</span></code></a>(name, seed)</p></td>
<td><p>Track the rng state.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#slapo.random.CudaRNGStatesTracker.fork" title="slapo.random.CudaRNGStatesTracker.fork"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fork</span></code></a>([name])</p></td>
<td><p>Fork the cuda rng state, perform operations, and exit with the original state.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="slapo.random.CudaRNGStatesTracker.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/random.html#CudaRNGStatesTracker.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.random.CudaRNGStatesTracker.reset" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Set to the initial state (no tracker).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.random.CudaRNGStatesTracker.get_states">
<span class="sig-name descname"><span class="pre">get_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/random.html#CudaRNGStatesTracker.get_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.random.CudaRNGStatesTracker.get_states" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Get rng states. Copy the dictionary so we have direct
pointers to the states, not just a pointer to the dictionary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.random.CudaRNGStatesTracker.set_states">
<span class="sig-name descname"><span class="pre">set_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/random.html#CudaRNGStatesTracker.set_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.random.CudaRNGStatesTracker.set_states" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Set the rng states. For efficiency purposes, we do not check
the size of seed for compatibility.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.random.CudaRNGStatesTracker.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/random.html#CudaRNGStatesTracker.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.random.CudaRNGStatesTracker.add" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Track the rng state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="slapo.random.CudaRNGStatesTracker.fork">
<span class="sig-name descname"><span class="pre">fork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model-parallel-rng'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/random.html#CudaRNGStatesTracker.fork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.random.CudaRNGStatesTracker.fork" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Fork the cuda rng state, perform operations, and exit with
the original state.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.random.get_cuda_rng_tracker">
<span class="sig-prename descclassname"><span class="pre">slapo.random.</span></span><span class="sig-name descname"><span class="pre">get_cuda_rng_tracker</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/random.html#get_cuda_rng_tracker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.random.get_cuda_rng_tracker" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Get cuda rng tracker.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.random.model_parallel_cuda_manual_seed">
<span class="sig-prename descclassname"><span class="pre">slapo.random.</span></span><span class="sig-name descname"><span class="pre">model_parallel_cuda_manual_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">always_enable_tp_seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/random.html#model_parallel_cuda_manual_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.random.model_parallel_cuda_manual_seed" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Initialize model parallel cuda seed.
This function should be called after the model parallel is
initialized. Also, no torch.cuda.manual_seed should be called
after this function. Basically, this is replacement for that
function.
Two sets of RNG states are tracked:</p>
<ul class="simple">
<li><dl class="simple">
<dt>default state: This is for data parallelism and is the same among a</dt><dd><p>set of model parallel GPUs but different across different model parallel groups.
This is used for example for dropout in the non-tensor-model-parallel regions.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>tensor-model-parallel state: This state is different among a set of model</dt><dd><p>parallel GPUs, but the same across data parallel groups. This is used for
example for dropout in model parallel regions.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – Random seed.</p></li>
<li><p><strong>tp_rank</strong> (<em>int</em>) – Tensor model parallel rank.</p></li>
<li><p><strong>always_enable_tp_seed</strong> (<em>bool</em>) – Always enable tensor model parallel seed. This is used when sequence
parallelism is enabled and all dropouts should use different seeds
even they are in the same TP group. Default is False, meaning that
tensor model parallel seed is only enabled with get_cuda_rng_tracker().fork().</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor model parallel seed of this rank.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.random.is_random_seed_set">
<span class="sig-prename descclassname"><span class="pre">slapo.random.</span></span><span class="sig-name descname"><span class="pre">is_random_seed_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/random.html#is_random_seed_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.random.is_random_seed_set" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Check if random seed is set.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="slapo.random.set_random_seed">
<span class="sig-prename descclassname"><span class="pre">slapo.random.</span></span><span class="sig-name descname"><span class="pre">set_random_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2013</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">always_enable_tp_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/slapo/random.html#set_random_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#slapo.random.set_random_seed" title="Permalink to this definition"><span>¶</span></a></dt>
<dd><p>Set random seed for reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – Random seed. Default is 2013.</p></li>
<li><p><strong>dp_rank</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Data parallel rank. Default is None means no data parallelism.</p></li>
<li><p><strong>pp_rank</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Pipeline parallel rank. Default is None means no pipeline parallelism.</p></li>
<li><p><strong>tp_rank</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Tensor model parallel rank. Default is None means no tensor parallelism.</p></li>
<li><p><strong>always_enable_tp_seed</strong> (<em>bool</em>) – Always enable tensor model parallel seed. This is used when sequence
parallelism is enabled and all dropouts should use different seeds
even they are in the same TP group. Default is False, meaning that
tensor model parallel seed is only enabled with get_cuda_rng_tracker().fork().</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Random seed of this rank.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</div>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="tracer.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">slapo.tracer</p>
      </div>
    </a>
    <a class="right-next"
       href="framework_dialect/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">slapo.framework_dialect</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Amazon
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023, Amazon.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>