Search.setIndex({docnames:["gallery/attention-single-gpu","gallery/index","gallery/mlp-multi-gpu","gallery/quick-start","gallery/sg_execution_times","genindex","index","python_api/framework_dialect/deepspeed/engine","python_api/framework_dialect/deepspeed/index","python_api/framework_dialect/deepspeed/pipeline","python_api/framework_dialect/index","python_api/framework_dialect/registry","python_api/index","python_api/initialization","python_api/op/attention","python_api/op/bias_gelu","python_api/op/cross_entropy","python_api/op/dropout","python_api/op/index","python_api/op/linear","python_api/op/mlp","python_api/pattern","python_api/pipeline","python_api/random","python_api/root","python_api/schedule","python_api/tracer","scripts/README","setup/index"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":5,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["gallery/attention-single-gpu.rst","gallery/index.rst","gallery/mlp-multi-gpu.rst","gallery/quick-start.rst","gallery/sg_execution_times.rst","genindex.rst","index.rst","python_api/framework_dialect/deepspeed/engine.rst","python_api/framework_dialect/deepspeed/index.rst","python_api/framework_dialect/deepspeed/pipeline.rst","python_api/framework_dialect/index.rst","python_api/framework_dialect/registry.rst","python_api/index.rst","python_api/initialization.rst","python_api/op/attention.rst","python_api/op/bias_gelu.rst","python_api/op/cross_entropy.rst","python_api/op/dropout.rst","python_api/op/index.rst","python_api/op/linear.rst","python_api/op/mlp.rst","python_api/pattern.rst","python_api/pipeline.rst","python_api/random.rst","python_api/root.rst","python_api/schedule.rst","python_api/tracer.rst","scripts/README.rst","setup/index.rst"],objects:{"":[[24,0,0,"-","slapo"]],"slapo.Database":[[24,2,1,"","commit"],[24,2,1,"","load"]],"slapo.LinearWithSeparateBias":[[24,2,1,"","forward"]],"slapo.ModulePattern":[[24,2,1,"","forward"]],"slapo.OrderedDict":[[24,2,1,"","clear"],[24,2,1,"","copy"],[24,2,1,"","fromkeys"],[24,2,1,"","items"],[24,2,1,"","keys"],[24,2,1,"","move_to_end"],[24,2,1,"","pop"],[24,2,1,"","popitem"],[24,2,1,"","setdefault"],[24,2,1,"","update"],[24,2,1,"","values"]],"slapo.Pattern":[[24,2,1,"","forward"]],"slapo.Space":[[24,2,1,"","cfg_dict_to_str"],[24,2,1,"","clone"],[24,2,1,"","create_symbol"],[24,2,1,"","log_space"],[24,2,1,"","next"],[24,2,1,"","reset"],[24,2,1,"","to_dict"]],"slapo.Symbol":[[24,2,1,"","add"],[24,2,1,"","fix_at"],[24,2,1,"","is_fixed"]],"slapo.framework_dialect":[[11,0,0,"-","registry"]],"slapo.framework_dialect.deepspeed":[[7,0,0,"-","engine"],[9,0,0,"-","pipeline"]],"slapo.framework_dialect.deepspeed.engine":[[7,4,1,"","init_ds_engine"]],"slapo.framework_dialect.deepspeed.pipeline":[[9,1,1,"","DeepSpeedPipeStageWrapper"],[9,1,1,"","WrappedTypeCode"],[9,4,1,"","analyze_tie_ranks"],[9,4,1,"","decode_metadata"],[9,4,1,"","deepspeed_pipe_engine"],[9,4,1,"","encode_metadata"],[9,4,1,"","flat_and_name_tensor_list"],[9,4,1,"","flatten"],[9,4,1,"","get_simple_nested_list_str"],[9,4,1,"","unflatten"]],"slapo.framework_dialect.deepspeed.pipeline.DeepSpeedPipeStageWrapper":[[9,2,1,"","forward"]],"slapo.framework_dialect.registry":[[11,4,1,"","get_all_dialects"],[11,4,1,"","get_dialect_cls"],[11,4,1,"","register_framework_dialect"]],"slapo.initialization":[[13,4,1,"","init_empty_weights"],[13,4,1,"","init_on_device"]],"slapo.op":[[14,0,0,"-","attention"],[15,0,0,"-","bias_gelu"],[16,0,0,"-","cross_entropy"],[17,0,0,"-","dropout"],[19,0,0,"-","linear"],[20,0,0,"-","mlp"]],"slapo.op.attention":[[14,1,1,"","AttentionOpWithRNG"],[14,1,1,"","FlashAttention"],[14,1,1,"","FlashAttentionOp"],[14,4,1,"","flash_attn_ref"],[14,4,1,"","get_xfoemers_attn_op_by_name"],[14,4,1,"","validate_sm_version"],[14,4,1,"","warning_once"],[14,4,1,"","xformers_ref"]],"slapo.op.attention.AttentionOpWithRNG":[[14,2,1,"","forward"]],"slapo.op.attention.FlashAttention":[[14,2,1,"","forward"],[14,2,1,"","reshape_for_scores"]],"slapo.op.attention.FlashAttentionOp":[[14,2,1,"","forward"]],"slapo.op.bias_gelu":[[15,1,1,"","BiasGeLUFunction"],[15,1,1,"","FusedBiasGELU"],[15,1,1,"","FusedBiasNewGELU"],[15,4,1,"","new_gelu"]],"slapo.op.bias_gelu.BiasGeLUFunction":[[15,2,1,"","backward"],[15,2,1,"","forward"]],"slapo.op.bias_gelu.FusedBiasGELU":[[15,2,1,"","forward"]],"slapo.op.bias_gelu.FusedBiasNewGELU":[[15,2,1,"","forward"]],"slapo.op.cross_entropy":[[16,1,1,"","ParallelCrossEntropy"],[16,4,1,"","vocab_parallel_cross_entropy"]],"slapo.op.cross_entropy.ParallelCrossEntropy":[[16,2,1,"","forward"]],"slapo.op.dropout":[[17,1,1,"","DropoutWithTensorParallel"]],"slapo.op.dropout.DropoutWithTensorParallel":[[17,2,1,"","forward"]],"slapo.op.linear":[[19,1,1,"","FusedQKV"],[19,1,1,"","LinearWithSeparateBias"]],"slapo.op.linear.FusedQKV":[[19,2,1,"","forward"]],"slapo.op.linear.LinearWithSeparateBias":[[19,2,1,"","forward"]],"slapo.op.mlp":[[20,1,1,"","FusedMLP"]],"slapo.op.mlp.FusedMLP":[[20,2,1,"","forward"]],"slapo.partial":[[24,3,1,"","args"],[24,3,1,"","func"],[24,3,1,"","keywords"]],"slapo.pattern":[[21,1,1,"","ModulePattern"],[21,1,1,"","Pattern"]],"slapo.pattern.ModulePattern":[[21,2,1,"","forward"]],"slapo.pattern.Pattern":[[21,2,1,"","forward"]],"slapo.pipeline":[[22,4,1,"","analyze_tie_weights"]],"slapo.random":[[23,1,1,"","CudaRNGStatesTracker"],[23,4,1,"","get_cuda_rng_tracker"],[23,4,1,"","is_random_seed_set"],[23,4,1,"","model_parallel_cuda_manual_seed"],[23,4,1,"","set_random_seed"]],"slapo.random.CudaRNGStatesTracker":[[23,2,1,"","add"],[23,2,1,"","fork"],[23,2,1,"","get_states"],[23,2,1,"","reset"],[23,2,1,"","set_states"]],"slapo.schedule":[[25,1,1,"","DictWithValidation"],[25,1,1,"","Schedule"],[25,1,1,"","ScheduleMetadata"],[25,1,1,"","SubgraphWrapper"],[25,4,1,"","consolidate_model"],[25,4,1,"","init_target_engine"],[25,4,1,"","register_primitive"]],"slapo.schedule.Schedule":[[25,2,1,"","find"],[25,2,1,"","find_node"],[25,2,1,"","find_subgraph"],[25,2,1,"","trace_for_pipeline"]],"slapo.schedule.SubgraphWrapper":[[25,2,1,"","forward"]],"slapo.tracer":[[26,4,1,"","trace"]],slapo:[[24,1,1,"","Database"],[24,1,1,"","DictWithValidation"],[24,3,1,"","FunctionType"],[24,1,1,"","LinearWithSeparateBias"],[24,1,1,"","ModulePattern"],[24,1,1,"","OrderedDict"],[24,1,1,"","Pattern"],[24,1,1,"","ScheduleMetadata"],[24,1,1,"","Space"],[24,1,1,"","Symbol"],[24,4,1,"","all_gather_forward_output"],[24,4,1,"","analyze_tie_weights"],[24,4,1,"","checkpoint"],[24,4,1,"","checkpoint_module"],[24,4,1,"","consolidate_model"],[24,4,1,"","dataclass"],[24,4,1,"","field"],[24,4,1,"","get_cuda_rng_tracker"],[24,4,1,"","get_dialect_cls"],[24,4,1,"","get_logger"],[24,4,1,"","get_output_type_after_sharding"],[24,4,1,"","init_empty_weights"],[24,4,1,"","init_target_engine"],[13,0,0,"-","initialization"],[24,4,1,"","is_random_seed_set"],[24,1,1,"","partial"],[21,0,0,"-","pattern"],[22,0,0,"-","pipeline"],[23,0,0,"-","random"],[24,4,1,"","reduce_backward_grad"],[24,4,1,"","reduce_forward_output"],[24,4,1,"","reduce_scatter_forward_output"],[24,4,1,"","register_primitive"],[24,4,1,"","scatter_forward_output"],[25,0,0,"-","schedule"],[24,4,1,"","set_random_seed"],[24,4,1,"","trace"],[24,4,1,"","trace_module"],[26,0,0,"-","tracer"],[24,4,1,"","transfer_hooks"],[24,4,1,"","transfer_hooks_for_fusion"]]},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","attribute","Python attribute"],"4":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:attribute","4":"py:function"},terms:{"0":[0,2,3,4,9,14,15,16,17,22,24],"00":[3,4],"001":3,"05":0,"080":[2,4],"09":4,"1":[0,2,3,9,14,16,22,24,25],"10":3,"100":3,"1024":[0,2,3],"11":3,"113kb":3,"12":3,"13":3,"139":[0,4],"14":3,"15":3,"16":[0,3],"17":3,"18":3,"181":[0,2],"19":3,"198":[3,4],"1e":[0,3],"2":[0,2,3,22,24,25],"20":[3,24],"2013":[23,24],"21":3,"22":3,"23":3,"3":[0,3],"30522":3,"3072":0,"3676bd2":14,"4":3,"4096":3,"417":4,"48a77cc":14,"5":[3,17],"512":3,"526":24,"571":3,"6":3,"7":3,"8":[0,2,3],"9":3,"boolean":15,"break":2,"case":[0,17,24],"class":[0,2,9,11,14,15,16,17,19,20,21,23,24,25],"default":[0,2,3,16,23,24],"do":[0,2,14,23,24],"final":[0,2,24,25],"float":[14,17],"function":[0,2,3,7,9,11,13,14,15,16,17,19,20,21,22,23,24,25,26],"import":[0,2,3,28],"int":[9,14,19,22,23,24],"long":3,"new":[0,15,24],"return":[0,2,3,9,14,15,17,19,21,22,23,24,25],"static":[0,2,15,24,25],"super":[0,2],"throw":24,"true":[0,2,3,13,14,15,19,24],"try":[0,25],"while":[0,9,13,14,15,16,17,19,20,21,24,25],A:[1,2,4,6,9,13,14,20,24,25],As:[0,2],By:[0,2,3],For:[0,9,23,24,25,28],If:[0,3,14,15,22,24,25,28],In:[0,2,17,24],It:[0,6,15,24],The:[0,2,3,9,14,15,17,22,24,25,28],Then:0,To:[0,2,28],_:[0,2,3],__annotations__:24,__hash__:24,__init__:[0,2,24],__repr__:24,_c:[0,2],_check:[0,2],_init_weight:3,_missing_typ:24,_nn:[0,2],_proj:0,_stacklevel:0,a_1:2,a_2:2,abil:25,about:[2,24],abov:[0,2,14],absolut:14,accept:[0,15],achiev:0,across:[16,23,24],activ:[2,15,24],ad:[0,24],adamw:3,add:[0,2,3,23,24],add_1:0,add_2:0,addit:[0,2],address:6,affect:0,after:[0,2,3,9,23,24],afterward:[9,14,15,16,17,19,20,21,24,25],again:0,alia:[15,24],all:[0,9,11,13,14,15,16,17,19,20,21,22,24,25],all_gather_forward_output:24,all_reduc:2,allow_non:[11,24],along:[2,24],alreadi:[0,2,3,22,24],also:[0,2,3,13,15,23,24,28],although:[9,14,15,16,17,19,20,21,24,25],alwai:[0,2],among:23,an:[0,2,3,13,14,15,24],analyz:[9,22,24],analyze_tie_rank:9,analyze_tie_weight:[22,24],ani:[0,15,22,24,25,26],annot:[0,2,24,25],anoth:[0,2],aot:15,apart:0,api:[0,3,6,25],appli:[0,3,14],applic:[24,25],apply_and_build_schedul:3,apply_causal_mask:[0,14],apply_schedul:3,approach:28,approxim:2,ar:[0,2,9,13,15,16,19,22,23,24],arbitrari:15,arg:[9,15,21,24],argument:[0,9,15,19,24,25],assign:[9,23,24],attach:[0,24],attent:[1,3,4,6,18],attention_mask:[0,3,14],attention_output:0,attentionopwithrng:14,attn:0,attn_bia:14,attn_nam:14,attn_op_nam:[0,14],attn_pdrop:14,attn_prob:0,attn_sch:0,attn_scor:0,attribut:[0,2,15,24,25],auto:14,autoconfig:3,automat:15,avail:[13,24],awslab:28,axi:[2,24],b:[2,3,24],b_1:2,b_2:2,back:14,backend:[0,2],backward:[2,3,15],base:[0,2,23,24],base_param:[24,25],basic:[0,2,23],basin:2,batch_siz:[0,14,16],becaus:[24,25],becom:[0,2,24],been:[0,24],befor:[2,24],begin:[2,24],behavior:24,belong:25,below:[0,2],bert:3,bertattent:3,bertembed:3,bertencod:3,bertintermedi:3,bertlay:3,bertlmheadmodel:3,bertlmpredictionhead:3,bertmodel:3,bertonlymlmhead:3,bertoutput:3,bertpredictionheadtransform:3,bertselfattent:3,bertselfoutput:3,between:6,bf16:[3,14],bia:[0,2,3,14,15,19,20,24,25],bias_ge_lu_0:2,bias_gelu:18,biasgelu:[2,15],biasgelu_0:2,biasgelufunct:15,blow:[13,24],bmatrix:2,bodi:[0,2],bool:[13,14,17,19,22,24],both:[0,2,24],bs:[0,3],buffer:[13,24],build:[2,3],bwd_post:2,c:[0,28],call:[0,2,3,9,14,15,16,17,19,20,21,23,24,25],call_modul:[0,25],callabl:[24,25],can:[0,2,3,14,15,23,25,28],candid:24,cannot:24,care:[2,9,14,15,16,17,19,20,21,24,25],cast:14,causal:14,cd:28,cdot:0,certain:2,cfg_dict:24,cfg_dict_to_str:24,chang:[0,6,14,24,28],check:[0,2,14,23,24],checkpoint:[3,24],checkpoint_modul:24,ckpt_ratio:3,cl:[3,24],clear:24,clearli:0,click:[0,2,3],clone:[3,24,28],cls_type:[11,24],code:[0,2,3,9],codebas:28,column:2,com:[14,28],come:2,command:28,commit:[14,24],common:[0,6],commun:9,compar:[0,24],comparison:24,compat:[15,23],compil:[0,2],complex:2,compon:2,comput:[2,9,14,15,16,17,19,20,21,24,25],concrete_arg:0,conduct:[0,3],config:[3,9,24],configur:3,connect:0,consequenti:0,consist:[0,2],consolid:[24,25],consolidate_model:[24,25],constraint:[0,25],consum:0,contain:25,context:[13,15,24],contigu:0,control:0,convent:2,converg:17,convert:[6,24],copi:[14,15,23,24],core:0,core_attn_subgraph:0,coreattent:[0,14],correct:[14,16],correctli:[0,2],correspond:[0,2,15,24],cover:[0,2],creat:[0,2,3,13,24,25],create_schedul:[0,2],create_symbol:24,creation:24,cross:[14,16],cross_entropi:18,ctx:15,cuda:[0,3,14,23,24],cudarngstatestrack:23,current:[0,15],custom:[3,24],cut:25,cutlass:14,d:[14,24],d_k:0,data:[2,3,9,15,23,24],databas:24,dataclass:24,dataflow:[0,2,25],db:24,db_file_nam:24,debug:[0,2,24],debugg:0,decod:[3,9],decode_metadata:9,decompos:[0,2],decoupl:6,deep:0,deepspe:[10,24,25],deepspeed_pipe_engin:9,deepspeedpipestagewrapp:9,def:[0,2,3],default_factori:24,defin:[0,2,9,14,15,16,17,19,20,21,24,25],definit:[0,2,6],defint:3,dens:[0,3],dense_bia:0,dense_weight:0,depict:0,detail:[2,3,24],determin:[2,24],dev:28,develop:28,devic:[1,3,4,6,9,13,15,17,19,24],dialect:[11,24,25],dict:[9,22,24,25,26],dictionari:[23,24],dictwithvalid:[24,25],differ:[0,2,17,22,23,24,25],differenti:15,dim:[0,24],dimens:[0,2,16,24],dimseion:16,direct:23,directli:[0,3,6,15,25,28],dispatch:[0,25],dist:[2,25],distribut:[2,16,24],doc:[0,24,25],documetn:14,doe:[0,24],doesn:[0,2],dot:0,download:[0,2,3],dp_rank:[23,24],dropout:[0,3,14,18,23],dropout_mask:14,dropout_p:14,dropoutwithtensorparallel:17,dtype:[0,3,15,19,24],due:[17,24],dunder:24,duplic:24,dure:[2,15],e:[0,15,24,28],each:[0,2,9,15,17],easi:0,easier:25,easiest:28,easili:[0,2],effect:28,effici:[0,6,14,23],either:[0,2,15,24],element:[0,24],elementwise_affin:[0,3],els:24,embed:[3,14],emploi:0,empti:[0,2,13,24],enabl:[2,6,13,24,25],encod:[3,9],encode_metadata:9,encoder_attention_mask:14,encoder_hidden_st:14,encount:14,end:[2,24],enforc:15,engin:[8,9,10,24,25],enhanc:0,enough:2,entropi:16,env:2,ep:[0,3],eq:24,equival:[14,15],error:[14,24],estim:14,etc:14,even:0,everi:[9,14,15,16,17,19,20,21,24,25],exactli:0,examin:24,exampl:[0,2,3,9,23,24],execut:[4,6],exist:24,exit:23,expect:2,explicitli:[0,2,3],express:[0,2,25],f52868287ca9bd3ac1598dad6ce818358c1beafc:14,f:[0,2,3,24],facebookresearch:14,factor:16,factori:[24,25],fals:[0,2,3,11,13,14,17,24,25],field:24,fifo:24,file:[4,24],find:[0,2,25],find_nod:25,find_subgraph:25,finish:0,first:[0,2,3,15,24],five:0,fix:24,fix_at:24,fixm:[24,25],flag:[0,2],flash:[3,14],flash_attention_op_0:0,flash_attn:0,flash_attn_ref:14,flashattent:14,flashattentionop:[0,14],flashattentionop_0:0,flashattentiontriton:14,flat:9,flat_and_name_tensor_list:9,flatten:[0,2,9],flexibl:2,float16:3,floattensor:14,follow:[0,2,14,15,24,28],footprint:24,fork:23,format:[9,25],former:[9,14,15,16,17,19,20,21,24,25],formula:15,forward:[0,2,9,14,15,16,17,19,20,21,24,25],found:[3,24],fp16:[3,9,14],fp32:14,frac:0,framework:[0,2,11,22,24,25],framework_dialect:12,from:[0,2,3,6,9,14,15,19,22,24,25,28],from_pretrain:3,fromkei:24,frozen:24,full:[0,2,3],func:24,functiontyp:[24,25],further:24,fuse:[0,2,3,15,20,24],fused_layer_norm_0:0,fused_linear:0,fused_qkv:[0,14],fused_qkv_0:0,fusedbiasgelu:15,fusedbiasnewgelu:15,fusedlayernorm:0,fusedlayernorm_0:0,fusedmlp:20,fusedqkv:[0,19],fusedqkv_0:0,fusion:[0,2,24],futur:24,fuzzi:[0,2],fwd_post:2,fwd_pre:24,fx:[0,9,25],g:[0,15],galleri:[0,2,3,4],gather:24,gelu:[2,15,20],geluactiv:3,gemm:0,gener:[0,1,2,3,24,25],get:[0,11,14,23,24],get_all_dialect:11,get_cuda_rng_track:[23,24],get_dialect_cl:[11,24],get_logg:24,get_output_type_after_shard:24,get_rank:2,get_simple_nested_list_str:9,get_stat:23,get_world_s:2,get_xfoemers_attn_op_by_nam:14,getattr_1:0,getattr_2:0,getattr_3:0,getattr_4:0,getitem:0,getitem_1:0,getitem_2:0,getitem_3:0,getitem_6:0,getitem_7:0,getitem_8:0,git:28,github:[14,28],give:0,given:[2,9,15,24,25],gloo:2,gpt:2,gpu:[0,2,4,9,23],grab:0,grad:15,grad_output:15,gradient:[15,24],gradual:0,graph:[0,2,25],graph_modul:[0,2],graphmodul:[0,2,9,24,26],greatli:0,group:[16,17,23,24,25],guid:[0,2,3],ha:[0,14,15,17,24],half:2,handl:0,hash:[14,24],have:[0,2,3,15,17,22,23,24,28],head:[0,14],head_dim:14,head_mask:14,help:0,helper:9,here:[0,2,3,24],hf:14,hidden:0,hidden_s:[0,2,14,16,19,20],hidden_st:[0,14,19,20],hierarch:[0,2],hierarchi:0,high:14,hold:2,hook:[9,14,15,16,17,19,20,21,24,25],hook_typ:24,how:[0,2],howev:24,hs:0,html:0,http:[0,14,28],hub:3,huggingfac:[3,14,15],hurt:17,id:[16,22,24],idea:0,identifi:24,idx:24,ignor:[9,14,15,16,17,19,20,21,24,25],implement:[0,2,3,14,19,24],implicitli:0,in_featur:[0,2,3,19,24],includ:[0,2,9,24,25],include_buff:[13,24],incorpor:0,independ:0,index:[6,24],infer:24,info:[0,2],inform:9,init:24,init_ds_engin:7,init_empty_weight:[13,24],init_on_devic:13,init_target_engin:[24,25],init_weight:[2,3],initi:[2,3,7,12,23,24,25],inject:3,inner:25,inp:[15,24],inplac:[0,3,17],input:[0,2,3,14,15,17,19,23,24],input_id:3,input_tensor:0,insert:[2,24],insid:25,instal:[0,2,3,6],instanc:[0,2,9,14,15,16,17,19,20,21,24,25],instanti:[0,2],instead:[0,2,9,14,15,16,17,19,20,21,24,25],intend:15,inter:9,intermedi:3,intermediate_act_fn:3,intermediate_s:20,invok:[24,25],ipynb:[0,2,3],ir:0,is_decod:3,is_fix:24,is_pipeline_partit:[22,24],is_random_seed_set:[23,24],item:[3,9,24],iter:24,its:[0,2,3,24],itself:6,jfc4050:14,jit:[0,2],json:3,jupyt:[0,2,3],just:[0,2,13,15,23,24],jvp:15,k:[0,14,24],k_proj:0,keep:[0,24],kei:[0,3,24],kernel:[0,2,3,14,15,20],key_lay:14,key_padding_mask:14,keyerror:24,keyword:[9,24],kwarg:[7,9,15,24,25,26],label:[3,16],label_smooth:16,lack:24,lambda:25,languag:6,larg:[3,6],last:24,later:[0,2,23,24,25],latter:[0,9,14,15,16,17,19,20,21,24,25],launch:0,layer:[0,2,3],layer_norm:0,layer_past:14,layernorm:[0,3],learn:0,left:[0,2],len:9,let:0,level:[0,2,22,24,25],leverag:[0,2,3],lib:[0,2],librari:0,lifo:24,like:[2,3,24],limit:14,line:[0,2],linear1:2,linear1_bia:2,linear1_weight:2,linear2:2,linear:[0,2,3,18,24],linearwithseparatebia:[0,2,19,24],list:[0,9,24,25],live:9,lm:[2,15,24],ln_pattern:0,ln_subgraph:0,load:[3,24],local:[0,2],log:[2,14,24],log_spac:24,logger:[2,24],logit:16,loop:3,loss:[3,16],loss_fn:9,low:2,lower:14,lr:3,lve:3,made:0,mai:[0,17,24],main:3,mainli:[9,14],maintain:9,make:[0,2,3,9,17,20,24,25],manag:[13,23,24],mani:15,manual_se:23,map:[22,24],mask:[14,17],match:[0,2,22,24,25],math:14,mathrm:0,matmul:0,matmul_1:0,matrix:[0,2],max_sm:14,maximum:14,mb:4,mean:[2,17,23,24],megatron:[2,15,24],memori:[22,24],merg:0,messag:[2,14],meta:[13,24],metadata:[9,24],metadata_str:9,method:[9,14,15,16,17,19,20,21,23,24,25],micro_batch_s:16,middl:24,min_sm:14,minimum:14,minut:[0,2,3],mlp:[1,4,6,18],mod:[0,2,9,25],mode:[2,15,24],model:[0,2,6,7,9,13,23,24,25,26],model_config:3,model_parallel_cuda_manual_se:23,model_schedul:3,modifi:[19,24],modul:[1,3,4,6,9,14,15,16,17,19,20,21,22,24,25,26],modulelist:3,modulepattern:[21,24],more:[0,2],most:[0,2,25],move:24,move_to_end:24,msg:14,much:0,multi:[1,4,6],multipl:[0,2],multipli:2,must:[15,16,24],n_head:0,name:[0,2,9,14,21,22,23,24,25],nativ:14,native_flash_attn:14,native_xform:[0,14],necessari:[0,2],need:[0,2,9,14,15,16,17,19,20,21,24,25],need_dist:[24,25],needs_input_grad:15,nest:9,new_gelu:15,new_mod:24,new_shap:0,next:[0,24],nhead:14,nn:[0,2,3,9,19,22,24,25,26],node:[0,2,24,25],non:[0,2,15,23],none:[0,2,9,14,15,16,17,19,21,23,24,25],norm:0,note:[9,14,24],notebook:[0,2,3],noth:24,notic:[0,2],num_attention_head:14,num_head:19,number:[0,15,22,24],numer:14,nvfuser:[0,2],object:[22,24,25],obtain:0,od:24,old:24,old_mod:24,onc:14,one:[0,2,9,14,15,16,17,19,20,21,24,25],ones:3,onli:[0,2,14,24,25],op:[0,12,24],oper:[0,2,3,14,15,23,24],opt_model:[2,3],optim:[1,4,6],option:[14,23,24,25],order:[14,24],ordereddict:24,org:0,organ:14,orig_act:20,origin:[0,2,9,17,23,24],original_nam:[0,2],other:[0,2,15,24],otherwis:[17,24,25],our:[0,23],out:[0,2],out_featur:[0,2,3,19,24],outdens:14,outer:25,output:[0,2,3,9,14,15,16,24,28],output_attent:14,output_proj:14,over:0,overhead:0,overridden:[9,14,15,16,17,19,20,21,24,25],p:[0,3,14,17],packag:[0,2,3,28],padding_idx:3,pair:24,paral:23,parallel:[2,3,16,17,23,24],parallelcrossentropi:16,param:[16,24],param_init_fn:[24,25],paramet:[0,3,9,13,14,16,17,19,22,23,24,25,26],parent:[24,25],part:[0,2,24],partial:[0,24],partit:[17,22,24],pass:[0,2,3,9,14,15,16,17,19,20,21,24,25],path:[9,25],pattern:[0,2,12,24,25],pattern_fn:25,pep:24,perceptron:2,perform:[0,2,3,9,14,15,16,17,19,20,21,23,24,25],permut:0,permute_1:0,permute_2:0,permute_for_scor:0,pip:28,pipelin:[8,10,12,23,24,25],pipeline_cutting_path:[24,25],pipelinemodul:9,pleas:[0,2,14,25],point:2,pointer:23,pop:24,popitem:24,posit:14,position_embed:3,pp_rank:[23,24],practic:0,predefin:[2,3],predict:3,prefix:3,present:24,preserv:[0,2],prev_weight:15,previou:2,primit:[0,2,6,24,25],print:[0,2,3,9,24,25,28],print_read:[0,2],probabl:[0,14],process:[14,24],processgroup:[24,25],product:0,progress:[0,6],proj:0,proj_sch:0,project:[0,14],properli:24,provid:[0,2,3,24,25,28],purpos:23,put:[13,24],py:[0,2,3,4],pypi:28,python3:[0,2],python:[0,2,3,6,28],pytorch:[0,2,6,14,24],q:[0,14],q_proj:0,qk:0,qkv:0,qkv_subgraph:0,queri:[0,3],query_lay:14,query_padding_mask:14,quick:[1,4,6],r:[0,15],rais:24,ram:[13,24],random:[12,17,24],rang:[3,16],rank:[2,9,16,23,24],ratio:3,re:24,readabl:0,realiz:2,reason:0,recip:[9,14,15,16,17,19,20,21,24,25],record:[24,25],recursivescriptmodul:[0,2],reduc:[0,24],reduce_backward_grad:24,reduce_forward_output:24,reduce_scatter_forward_output:24,reflect:0,regex:25,regex_or_pattern_fn:25,region:[17,23],regist:[9,11,14,15,16,17,19,20,21,24,25],register_framework_dialect:11,register_primit:[24,25],registr:11,registri:10,regular:[0,25],relat:9,reli:[24,25],remain:0,rememb:24,remov:24,reorder:14,reorder_op:14,replac:[0,2,23],replai:[24,25],repr:24,repres:15,reproduc:[23,24],requir:[0,15],reset:[23,24],reshape_for_scor:14,reshaped_qkv:0,resid_pdrop:[14,20],residu:[0,25],restor:[9,24],result:[2,24],ret:9,retriev:15,revers:9,rich:24,right:[0,2],rng:[23,24],row:2,run:[0,2,3,9,14,15,16,17,19,20,21,24,25,28],runtim:[24,25],s:[2,3,24],same:[0,14,17,19,22,23,24],satisfi:[0,25],save:[15,24],save_for_backward:15,save_for_forward:15,scale:[0,14],scaled_dot_product:0,scatter:24,scatter_forward_output:24,sch:[0,2,3,24,25],sch_metadata:9,schedul:[0,2,3,6,9,12,24],schedulemetadata:[9,24,25],script:[0,2,3],seamlessli:0,second:[0,2,3],see:[0,2,24],seed:[17,23,24],self:[0,2,3,14],self_attn:0,self_output:0,selfattent:[0,14],separ:[0,2],seq:0,seq_len:0,seq_length:3,seqlen_k:14,seqlen_q:14,sequenc:17,sequence_length:16,set:[0,6,22,23,24],set_random_se:[23,24],set_stat:23,setdefault:24,setup:2,sever:2,shallow:24,shape:[0,14],shard:[0,2,24,25],sharded_s:24,share:[22,24],should:[0,9,14,15,16,17,19,20,21,22,23,24,25],show:[0,2],shown:[0,2],signatur:14,silent:[9,14,15,16,17,19,20,21,24,25],similarli:0,simpl:24,simpler:0,simpli:0,sinc:[0,2,9,14,15,16,17,19,20,21,24,25],singl:[1,2,4,6],site:[0,2],size:[15,23,24],slapo:[0,2,12,28],slice:0,sm:14,small:0,smooth:16,so:[0,3,22,23,24,25],softmax:[0,14],softmax_scal:14,sourc:[0,2,3,7,9,11,13,14,15,16,17,19,20,21,22,23,24,25,26,28],space:24,special:14,specif:[24,25],specifi:[0,2,13,24,25],sphinx:[0,1,2,3],split:[0,16,24],sqrt:[0,14],squeez:0,stabl:0,stage:[9,22,24,25],stage_id:9,stage_id_2_arg_nam:9,stage_modul:9,standalon:3,start:[1,4,23],state:[0,23,24],statu:[24,25],step:3,still:[0,2,3],store:[15,24],str:[9,14,22,24,25,26],strategi:2,string:[9,24],structur:[0,9],sub:25,subclass:[9,14,15,16,17,19,20,21,24,25],subgraph:[0,2,24,25],subgraphwrapp:25,submodul:[0,22,24,25],subschedul:0,successfulli:28,suffix:9,support:[0,2,14,22,24,25],suppos:17,sure:[0,2,3,9,17],symbol:24,sync:[2,24],sync_op_or_fn:2,synchron:2,system:[0,2],t1:9,t2:9,t:[0,2,15],take:[0,9,14,15,16,17,19,20,21,24,25,28],tape:[24,25],target:[11,16,24,25],tension:6,tensor:[0,2,3,9,14,15,16,17,19,23,24],tensor_parallel_output_grad:24,test:14,thei:[2,15],them:[0,9,14,15,16,17,19,20,21,24,25],therefor:[13,24],thi:[0,2,3,9,13,14,15,16,17,19,20,21,22,23,24,25],thing:0,those:0,though:[0,15],three:0,through:[0,3,28],thu:[0,6],ti:[9,22,24],tie:[22,24],tie_group:[22,24],tie_weight:[24,25],tie_weight_group:9,time:[0,2,3],to_dict:24,todo:[24,25],togeth:0,token_type_embed:3,token_type_id:3,top:[0,22,24,25],top_mod:[22,24],topolog:[9,24,25],torch:[0,2,3,9,13,14,16,19,22,23,24],torchscript:[0,2],total:[0,2,3,4],total_stag:9,tp_rank:[23,24],trace:[0,2,22,24,25,26],trace_for_pipelin:25,trace_modul:24,tracer:[0,12],track:[23,24],tracker:[23,24],tradit:0,train:[0,3,6],training_script_arg:24,transfer:24,transfer_hook:24,transfer_hooks_for_fus:24,transform:[0,2,3,15],transform_act_fn:3,transpos:[0,2,14],transpose_for_scor:14,triangular:14,triton:14,truediv:0,tunabl:24,tune:24,tupl:[14,15,22,24,25],tutori:[0,2],two:[0,2,22,23,24,28],type:[0,2,3,9,14,15,17,19,21,22,23,24,25],uncas:3,under:[13,24],unflatten:9,union:25,unsafe_hash:24,until:25,upcast:14,updat:24,update_space_fn:24,us:[0,2,3,6,9,13,14,15,17,20,23,24,25],usabl:6,use_cach:14,use_reentr:24,user:[0,2,3,6],userwarn:[0,2],usr:[0,2],usual:[0,2,3],v:[0,14,24],v_proj:0,val:24,valid:14,validate_sm_vers:14,valu:[0,3,9,15,24],value_lay:14,verifi:28,version:14,vertic:0,view:[0,24],view_1:0,view_2:0,vjp:15,vocab:16,vocab_parallel_cross_entropi:16,vocab_parallel_logit:16,w:15,wa:24,wai:[0,28],walk:3,want:[0,2,3],warn:[0,2,14],warning_onc:14,we:[0,2,3,9,14,17,23,24,25,28],weight:[0,2,9,22,24,25],were:15,when:[13,14,16,24,25,28],where:[0,2],wherea:24,whether:[2,13,14,15,22,24,25],which:[0,2,13,17,24],whose:25,wise:0,within:[9,14,15,16,17,19,20,21,24,25],without:[6,9,14],word_embed:3,work:0,world_siz:[2,19],would:[13,24],wrap:[0,2,9,24,25],wrappedtypecod:9,wrapper:[14,20,22],write:2,x:[0,2,14,19,24,25],xa:2,xa_1:2,xa_2:2,xformer:[0,14],xformers_ref:14,yet:24,you:[0,2,3,14,15,25,28]},titles:["Optimize Attention Module on A Single Device","Gallery","Optimize MLP Module on Multi-Device","Quick Start","Computation times","Index","Slapo Documentation","slapo.framework_dialect.deepspeed.engine","slapo.framework_dialect.deepspeed","slapo.framework_dialect.deepspeed.pipeline","slapo.framework_dialect","slapo.framework_dialect.registry","Python API","slapo.initialization","slapo.op.attention","slapo.op.bias_gelu","slapo.op.cross_entropy","slapo.op.dropout","slapo.op","slapo.op.linear","slapo.op.mlp","slapo.pattern","slapo.pipeline","slapo.random","slapo","slapo.schedule","slapo.tracer","Gallery","Installation"],titleterms:{A:0,api:12,attent:[0,14],bias_gelu:15,comput:4,cross_entropi:16,deepspe:[7,8,9],devic:[0,2],document:6,dropout:17,engin:7,framework_dialect:[7,8,9,10,11],galleri:[1,27],get:6,index:5,initi:13,instal:28,linear:19,mlp:[2,20],model:3,modul:[0,2],multi:2,op:[14,15,16,17,18,19,20],optim:[0,2,3],pattern:21,pipelin:[9,22],python:12,pytorch:3,quick:3,random:23,refer:6,registri:11,schedul:25,singl:0,slapo:[3,6,7,8,9,10,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26],start:[3,6],submodul:[8,10,18],time:4,tracer:26,tutori:6}})