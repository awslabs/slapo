Search.setIndex({docnames:["gallery/attention-single-gpu","gallery/index","gallery/sg_execution_times","genindex","index","python_api/framework_dialect/deepspeed/engine","python_api/framework_dialect/deepspeed/index","python_api/framework_dialect/deepspeed/pipeline","python_api/framework_dialect/index","python_api/framework_dialect/registry","python_api/index","python_api/initialization","python_api/op/attention","python_api/op/bias_gelu","python_api/op/cross_entropy","python_api/op/dropout","python_api/op/index","python_api/op/linear","python_api/op/mlp","python_api/pattern","python_api/pipeline","python_api/random","python_api/root","python_api/schedule","python_api/tracer","scripts/README","setup/index"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":5,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["gallery/attention-single-gpu.rst","gallery/index.rst","gallery/sg_execution_times.rst","genindex.rst","index.rst","python_api/framework_dialect/deepspeed/engine.rst","python_api/framework_dialect/deepspeed/index.rst","python_api/framework_dialect/deepspeed/pipeline.rst","python_api/framework_dialect/index.rst","python_api/framework_dialect/registry.rst","python_api/index.rst","python_api/initialization.rst","python_api/op/attention.rst","python_api/op/bias_gelu.rst","python_api/op/cross_entropy.rst","python_api/op/dropout.rst","python_api/op/index.rst","python_api/op/linear.rst","python_api/op/mlp.rst","python_api/pattern.rst","python_api/pipeline.rst","python_api/random.rst","python_api/root.rst","python_api/schedule.rst","python_api/tracer.rst","scripts/README.rst","setup/index.rst"],objects:{"":[[22,0,0,"-","slapo"]],"slapo.Database":[[22,2,1,"","commit"],[22,2,1,"","load"]],"slapo.LinearWithSeparateBias":[[22,2,1,"","forward"]],"slapo.ModulePattern":[[22,2,1,"","forward"]],"slapo.OrderedDict":[[22,2,1,"","clear"],[22,2,1,"","copy"],[22,2,1,"","fromkeys"],[22,2,1,"","items"],[22,2,1,"","keys"],[22,2,1,"","move_to_end"],[22,2,1,"","pop"],[22,2,1,"","popitem"],[22,2,1,"","setdefault"],[22,2,1,"","update"],[22,2,1,"","values"]],"slapo.Pattern":[[22,2,1,"","forward"]],"slapo.Space":[[22,2,1,"","cfg_dict_to_str"],[22,2,1,"","clone"],[22,2,1,"","create_symbol"],[22,2,1,"","log_space"],[22,2,1,"","next"],[22,2,1,"","reset"],[22,2,1,"","to_dict"]],"slapo.Symbol":[[22,2,1,"","add"],[22,2,1,"","fix_at"],[22,2,1,"","is_fixed"]],"slapo.framework_dialect":[[9,0,0,"-","registry"]],"slapo.framework_dialect.deepspeed":[[5,0,0,"-","engine"],[7,0,0,"-","pipeline"]],"slapo.framework_dialect.deepspeed.engine":[[5,4,1,"","init_ds_engine"]],"slapo.framework_dialect.deepspeed.pipeline":[[7,1,1,"","DeepSpeedPipeStageWrapper"],[7,1,1,"","WrappedTypeCode"],[7,4,1,"","analyze_tie_ranks"],[7,4,1,"","decode_metadata"],[7,4,1,"","deepspeed_pipe_engine"],[7,4,1,"","encode_metadata"],[7,4,1,"","flat_and_name_tensor_list"],[7,4,1,"","flatten"],[7,4,1,"","get_simple_nested_list_str"],[7,4,1,"","unflatten"]],"slapo.framework_dialect.deepspeed.pipeline.DeepSpeedPipeStageWrapper":[[7,2,1,"","forward"]],"slapo.framework_dialect.registry":[[9,4,1,"","get_all_dialects"],[9,4,1,"","get_dialect_cls"],[9,4,1,"","register_framework_dialect"]],"slapo.initialization":[[11,4,1,"","init_empty_weights"],[11,4,1,"","init_on_device"]],"slapo.op":[[12,0,0,"-","attention"],[13,0,0,"-","bias_gelu"],[14,0,0,"-","cross_entropy"],[15,0,0,"-","dropout"],[17,0,0,"-","linear"],[18,0,0,"-","mlp"]],"slapo.op.attention":[[12,1,1,"","AttentionOpWithRNG"],[12,1,1,"","FlashAttention"],[12,1,1,"","FlashAttentionOp"],[12,4,1,"","flash_attn_ref"],[12,4,1,"","get_xfoemers_attn_op_by_name"],[12,4,1,"","validate_sm_version"],[12,4,1,"","warning_once"],[12,4,1,"","xformers_ref"]],"slapo.op.attention.AttentionOpWithRNG":[[12,2,1,"","forward"]],"slapo.op.attention.FlashAttention":[[12,2,1,"","forward"],[12,2,1,"","reshape_for_scores"]],"slapo.op.attention.FlashAttentionOp":[[12,2,1,"","forward"]],"slapo.op.bias_gelu":[[13,1,1,"","BiasGeLUFunction"],[13,1,1,"","FusedBiasGELU"],[13,1,1,"","FusedBiasNewGELU"],[13,4,1,"","new_gelu"]],"slapo.op.bias_gelu.BiasGeLUFunction":[[13,2,1,"","backward"],[13,2,1,"","forward"]],"slapo.op.bias_gelu.FusedBiasGELU":[[13,2,1,"","forward"]],"slapo.op.bias_gelu.FusedBiasNewGELU":[[13,2,1,"","forward"]],"slapo.op.cross_entropy":[[14,1,1,"","ParallelCrossEntropy"],[14,4,1,"","vocab_parallel_cross_entropy"]],"slapo.op.cross_entropy.ParallelCrossEntropy":[[14,2,1,"","forward"]],"slapo.op.dropout":[[15,1,1,"","DropoutWithTensorParallel"]],"slapo.op.dropout.DropoutWithTensorParallel":[[15,2,1,"","forward"]],"slapo.op.linear":[[17,1,1,"","FusedQKV"],[17,1,1,"","LinearWithSeparateBias"]],"slapo.op.linear.FusedQKV":[[17,2,1,"","forward"]],"slapo.op.linear.LinearWithSeparateBias":[[17,2,1,"","forward"]],"slapo.op.mlp":[[18,1,1,"","FusedMLP"]],"slapo.op.mlp.FusedMLP":[[18,2,1,"","forward"]],"slapo.partial":[[22,3,1,"","args"],[22,3,1,"","func"],[22,3,1,"","keywords"]],"slapo.pattern":[[19,1,1,"","ModulePattern"],[19,1,1,"","Pattern"]],"slapo.pattern.ModulePattern":[[19,2,1,"","forward"]],"slapo.pattern.Pattern":[[19,2,1,"","forward"]],"slapo.pipeline":[[20,4,1,"","analyze_tie_weights"]],"slapo.random":[[21,1,1,"","CudaRNGStatesTracker"],[21,4,1,"","get_cuda_rng_tracker"],[21,4,1,"","is_random_seed_set"],[21,4,1,"","model_parallel_cuda_manual_seed"],[21,4,1,"","set_random_seed"]],"slapo.random.CudaRNGStatesTracker":[[21,2,1,"","add"],[21,2,1,"","fork"],[21,2,1,"","get_states"],[21,2,1,"","reset"],[21,2,1,"","set_states"]],"slapo.schedule":[[23,1,1,"","DictWithValidation"],[23,1,1,"","Schedule"],[23,1,1,"","ScheduleMetadata"],[23,1,1,"","SubgraphWrapper"],[23,4,1,"","consolidate_model"],[23,4,1,"","init_target_engine"],[23,4,1,"","register_primitive"]],"slapo.schedule.Schedule":[[23,2,1,"","find"],[23,2,1,"","find_node"],[23,2,1,"","find_subgraph"],[23,2,1,"","trace_for_pipeline"]],"slapo.schedule.SubgraphWrapper":[[23,2,1,"","forward"]],"slapo.tracer":[[24,4,1,"","trace"]],slapo:[[22,1,1,"","Database"],[22,1,1,"","DictWithValidation"],[22,3,1,"","FunctionType"],[22,1,1,"","LinearWithSeparateBias"],[22,1,1,"","ModulePattern"],[22,1,1,"","OrderedDict"],[22,1,1,"","Pattern"],[22,1,1,"","ScheduleMetadata"],[22,1,1,"","Space"],[22,1,1,"","Symbol"],[22,4,1,"","all_gather_forward_output"],[22,4,1,"","analyze_tie_weights"],[22,4,1,"","checkpoint"],[22,4,1,"","checkpoint_module"],[22,4,1,"","consolidate_model"],[22,4,1,"","dataclass"],[22,4,1,"","field"],[22,4,1,"","get_cuda_rng_tracker"],[22,4,1,"","get_dialect_cls"],[22,4,1,"","get_logger"],[22,4,1,"","get_output_type_after_sharding"],[22,4,1,"","init_empty_weights"],[22,4,1,"","init_target_engine"],[11,0,0,"-","initialization"],[22,4,1,"","is_random_seed_set"],[22,1,1,"","partial"],[19,0,0,"-","pattern"],[20,0,0,"-","pipeline"],[21,0,0,"-","random"],[22,4,1,"","reduce_backward_grad"],[22,4,1,"","reduce_forward_output"],[22,4,1,"","reduce_scatter_forward_output"],[22,4,1,"","register_primitive"],[22,4,1,"","scatter_forward_output"],[23,0,0,"-","schedule"],[22,4,1,"","set_random_seed"],[22,4,1,"","trace"],[22,4,1,"","trace_module"],[24,0,0,"-","tracer"],[22,4,1,"","transfer_hooks"],[22,4,1,"","transfer_hooks_for_fusion"]]},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","attribute","Python attribute"],"4":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:attribute","4":"py:function"},terms:{"0":[0,2,7,12,13,14,15,20,22],"00":2,"05":0,"1":[0,7,12,14,20,22,23],"1024":0,"148":[0,2],"16":0,"181":0,"1e":0,"2":[0,20,22,23],"20":22,"2013":[21,22],"3":0,"3072":0,"3676bd2":12,"48a77cc":12,"5":15,"526":22,"8":0,"boolean":13,"case":[0,15,22],"class":[0,7,9,12,13,14,15,17,18,19,21,22,23],"default":[0,14,21,22],"do":[0,12,21,22],"final":[0,22,23],"float":[12,15],"function":[0,5,7,9,11,12,13,14,15,17,18,19,20,21,22,23,24],"import":[0,26],"int":[7,12,17,20,21,22],"new":[0,13,22],"return":[0,7,12,13,15,17,19,20,21,22,23],"static":[0,13,22,23],"super":0,"throw":22,"true":[0,11,12,13,17,22],"try":[0,23],"while":[0,7,11,12,13,14,15,17,18,19,22,23],A:[1,2,4,7,11,12,18,22,23],As:0,By:0,For:[0,7,21,22,23,26],If:[0,12,13,20,22,23,26],In:[0,15,22],It:[0,4,13,22],The:[0,7,12,13,15,20,22,23,26],Then:0,To:[0,26],_:0,__annotations__:22,__hash__:22,__init__:[0,22],__repr__:22,_c:0,_check:0,_missing_typ:22,_nn:0,_proj:0,_stacklevel:0,abil:23,about:22,abov:[0,12],absolut:12,accept:[0,13],achiev:0,across:[14,21,22],activ:[13,22],ad:[0,22],add:[0,21,22],add_1:0,add_2:0,addit:0,address:4,affect:0,after:[0,7,21,22],afterward:[7,12,13,14,15,17,18,19,22,23],again:0,alia:[13,22],all:[0,7,9,11,12,13,14,15,17,18,19,20,22,23],all_gather_forward_output:22,allow_non:[9,22],along:22,alreadi:[0,20,22],also:[0,11,13,21,22,26],although:[7,12,13,14,15,17,18,19,22,23],alwai:0,among:21,an:[0,11,12,13,22],analyz:[7,20,22],analyze_tie_rank:7,analyze_tie_weight:[20,22],ani:[0,13,20,22,23,24],annot:[0,22,23],anoth:0,aot:13,apart:0,api:[0,4,23],appli:[0,12],applic:[22,23],apply_causal_mask:[0,12],approach:26,ar:[0,7,11,13,14,17,20,21,22],arbitrari:13,arg:[7,13,19,22],argument:[0,7,13,17,22,23],assign:[7,21,22],attach:[0,22],attent:[1,2,4,16],attention_mask:[0,12],attention_output:0,attentionopwithrng:12,attn:0,attn_bia:12,attn_nam:12,attn_op_nam:[0,12],attn_pdrop:12,attn_prob:0,attn_sch:0,attn_scor:0,attribut:[0,13,22,23],auto:12,automat:13,avail:[11,22],awslab:26,axi:22,b:22,back:12,backend:0,backward:13,base:[0,21,22],base_param:[22,23],basic:[0,21],batch_siz:[0,12,14],becaus:[22,23],becom:[0,22],been:[0,22],befor:22,begin:22,behavior:22,belong:23,below:0,between:4,bf16:12,bia:[0,12,13,17,18,22,23],bias_gelu:16,biasgelu:13,biasgelufunct:13,blow:[11,22],bodi:0,bool:[11,12,15,17,20,22],both:[0,22],bs:0,buffer:[11,22],c:[0,26],call:[0,7,12,13,14,15,17,18,19,21,22,23],call_modul:[0,23],callabl:[22,23],can:[0,12,13,21,23,26],candid:22,cannot:22,care:[7,12,13,14,15,17,18,19,22,23],cast:12,causal:12,cd:26,cdot:0,cfg_dict:22,cfg_dict_to_str:22,chang:[0,4,12,22,26],check:[0,12,21,22],checkpoint:22,checkpoint_modul:22,cl:22,clear:22,clearli:0,click:0,clone:[22,26],cls_type:[9,22],code:[0,7],codebas:26,com:[12,26],command:26,commit:[12,22],common:[0,4],commun:7,compar:[0,22],comparison:22,compat:[13,21],compil:0,comput:[7,12,13,14,15,17,18,19,22,23],concrete_arg:0,conduct:0,config:[7,22],connect:0,consequenti:0,consist:0,consolid:[22,23],consolidate_model:[22,23],constraint:[0,23],consum:0,contain:23,context:[11,13,22],contigu:0,control:0,converg:15,convert:[4,22],copi:[12,13,21,22],core:0,core_attn_subgraph:0,coreattent:[0,12],correct:[12,14],correctli:0,correspond:[0,13,22],cover:0,creat:[0,11,22,23],create_schedul:0,create_symbol:22,creation:22,cross:[12,14],cross_entropi:16,ctx:13,cuda:[0,12,21,22],cudarngstatestrack:21,current:[0,13],custom:22,cut:23,cutlass:12,d:[12,22],d_k:0,data:[7,13,21,22],databas:22,dataclass:22,dataflow:[0,23],db:22,db_file_nam:22,debug:[0,22],debugg:0,decod:7,decode_metadata:7,decompos:0,decoupl:4,deep:0,deepspe:[8,22,23],deepspeed_pipe_engin:7,deepspeedpipestagewrapp:7,def:0,default_factori:22,defin:[0,7,12,13,14,15,17,18,19,22,23],definit:[0,4],dens:0,dense_bia:0,dense_weight:0,depict:0,detail:22,determin:22,dev:26,develop:26,devic:[1,2,4,7,11,13,15,17,22],dialect:[9,22,23],dict:[7,20,22,23,24],dictionari:[21,22],dictwithvalid:[22,23],differ:[0,15,20,21,22,23],differenti:13,dim:[0,22],dimens:[0,14,22],dimseion:14,direct:21,directli:[0,4,13,23,26],dispatch:[0,23],dist:23,distribut:[14,22],doc:[0,22,23],documetn:12,doe:[0,22],doesn:0,dot:0,download:0,dp_rank:[21,22],dropout:[0,12,16,21],dropout_mask:12,dropout_p:12,dropoutwithtensorparallel:15,dtype:[0,13,17,22],due:[15,22],dunder:22,duplic:22,dure:13,e:[0,13,22,26],each:[0,7,13,15],easi:0,easier:23,easiest:26,easili:0,effect:26,effici:[0,4,12,21],either:[0,13,22],element:[0,22],elementwise_affin:0,els:22,embed:12,emploi:0,empti:[0,11,22],enabl:[4,11,22,23],encod:7,encode_metadata:7,encoder_attention_mask:12,encoder_hidden_st:12,encount:12,end:22,enforc:13,engin:[6,7,8,22,23],enhanc:0,entropi:14,ep:0,eq:22,equival:[12,13],error:[12,22],estim:12,etc:12,even:0,everi:[7,12,13,14,15,17,18,19,22,23],exactli:0,examin:22,exampl:[0,7,21,22],execut:[2,4],exist:22,exit:21,explicitli:0,express:[0,23],f52868287ca9bd3ac1598dad6ce818358c1beafc:12,f:[0,22],facebookresearch:12,factor:14,factori:[22,23],fals:[0,9,11,12,15,22,23],field:22,fifo:22,file:[2,22],find:[0,23],find_nod:23,find_subgraph:23,finish:0,first:[0,13,22],five:0,fix:22,fix_at:22,fixm:[22,23],flag:0,flash:12,flash_attention_op_0:0,flash_attn:0,flash_attn_ref:12,flashattent:12,flashattentionop:[0,12],flashattentionop_0:0,flashattentiontriton:12,flat:7,flat_and_name_tensor_list:7,flatten:[0,7],floattensor:12,follow:[0,12,13,22,26],footprint:22,fork:21,format:[7,23],former:[7,12,13,14,15,17,18,19,22,23],formula:13,forward:[0,7,12,13,14,15,17,18,19,22,23],found:22,fp16:[7,12],fp32:12,frac:0,framework:[0,9,20,22,23],framework_dialect:10,from:[0,4,7,12,13,17,20,22,23,26],fromkei:22,frozen:22,full:0,func:22,functiontyp:[22,23],further:22,fuse:[0,13,18,22],fused_layer_norm_0:0,fused_linear:0,fused_qkv:[0,12],fused_qkv_0:0,fusedbiasgelu:13,fusedbiasnewgelu:13,fusedlayernorm:0,fusedlayernorm_0:0,fusedmlp:18,fusedqkv:[0,17],fusedqkv_0:0,fusion:[0,22],futur:22,fuzzi:0,fwd_pre:22,fx:[0,7,23],g:[0,13],galleri:[0,2],gather:22,gelu:[13,18],gemm:0,gener:[0,1,22,23],get:[0,9,12,21,22],get_all_dialect:9,get_cuda_rng_track:[21,22],get_dialect_cl:[9,22],get_logg:22,get_output_type_after_shard:22,get_simple_nested_list_str:7,get_stat:21,get_xfoemers_attn_op_by_nam:12,getattr_1:0,getattr_2:0,getattr_3:0,getattr_4:0,getitem:0,getitem_1:0,getitem_2:0,getitem_3:0,getitem_6:0,getitem_7:0,getitem_8:0,git:26,github:[12,26],give:0,given:[7,13,22,23],gpu:[0,2,7,21],grab:0,grad:13,grad_output:13,gradient:[13,22],gradual:0,graph:[0,23],graph_modul:0,graphmodul:[0,7,22,24],greatli:0,group:[14,15,21,22,23],guid:0,ha:[0,12,13,15,22],handl:0,hash:[12,22],have:[0,13,15,20,21,22,26],head:[0,12],head_dim:12,head_mask:12,help:0,helper:7,here:[0,22],hf:12,hidden:0,hidden_s:[0,12,14,17,18],hidden_st:[0,12,17,18],hierarch:0,hierarchi:0,high:12,hook:[7,12,13,14,15,17,18,19,22,23],hook_typ:22,how:0,howev:22,hs:0,html:0,http:[0,12,26],huggingfac:[12,13],hurt:15,id:[14,20,22],idea:0,identifi:22,idx:22,ignor:[7,12,13,14,15,17,18,19,22,23],implement:[0,12,17,22],implicitli:0,in_featur:[0,17,22],includ:[0,7,22,23],include_buff:[11,22],incorpor:0,independ:0,index:[4,22],infer:22,info:0,inform:7,init:22,init_ds_engin:5,init_empty_weight:[11,22],init_on_devic:11,init_target_engin:[22,23],initi:[5,10,21,22,23],inner:23,inp:[13,22],inplac:[0,15],input:[0,12,13,15,17,21,22],input_tensor:0,insert:22,insid:23,instal:[0,4],instanc:[0,7,12,13,14,15,17,18,19,22,23],instanti:0,instead:[0,7,12,13,14,15,17,18,19,22,23],intend:13,inter:7,intermediate_s:18,invok:[22,23],ipynb:0,ir:0,is_fix:22,is_pipeline_partit:[20,22],is_random_seed_set:[21,22],item:[7,22],iter:22,its:[0,22],itself:4,jfc4050:12,jit:0,jupyt:0,just:[0,11,13,21,22],jvp:13,k:[0,12,22],k_proj:0,keep:[0,22],kei:[0,22],kernel:[0,12,13,18],key_lay:12,key_padding_mask:12,keyerror:22,keyword:[7,22],kwarg:[5,7,13,22,23,24],label:14,label_smooth:14,lack:22,lambda:23,languag:4,larg:4,last:22,later:[0,21,22,23],latter:[0,7,12,13,14,15,17,18,19,22,23],launch:0,layer:0,layer_norm:0,layer_past:12,layernorm:0,learn:0,left:0,len:7,let:0,level:[0,20,22,23],leverag:0,lib:0,librari:0,lifo:22,like:22,limit:12,line:0,linear:[0,16,22],linearwithseparatebia:[0,17,22],list:[0,7,22,23],live:7,lm:[13,22],ln_pattern:0,ln_subgraph:0,load:22,local:0,log:[12,22],log_spac:22,logger:22,logit:14,loss:14,loss_fn:7,lower:12,made:0,mai:[0,15,22],mainli:[7,12],maintain:7,make:[0,7,15,18,22,23],manag:[11,21,22],mani:13,manual_se:21,map:[20,22],mask:[12,15],match:[0,20,22,23],math:12,mathrm:0,matmul:0,matmul_1:0,matrix:0,max_sm:12,maximum:12,mb:2,mean:[15,21,22],megatron:[13,22],memori:[20,22],merg:0,messag:12,meta:[11,22],metadata:[7,22],metadata_str:7,method:[7,12,13,14,15,17,18,19,21,22,23],micro_batch_s:14,middl:22,min_sm:12,minimum:12,minut:0,mlp:16,mod:[0,7,23],mode:[13,22],model:[0,4,5,7,11,21,22,23,24],model_parallel_cuda_manual_se:21,modifi:[17,22],modul:[1,2,4,7,12,13,14,15,17,18,19,20,22,23,24],modulepattern:[19,22],more:0,most:[0,23],move:22,move_to_end:22,msg:12,much:0,multipl:0,must:[13,14,22],n_head:0,name:[0,7,12,19,20,21,22,23],nativ:12,native_flash_attn:12,native_xform:[0,12],necessari:0,need:[0,7,12,13,14,15,17,18,19,22,23],need_dist:[22,23],needs_input_grad:13,nest:7,new_gelu:13,new_mod:22,new_shap:0,next:[0,22],nhead:12,nn:[0,7,17,20,22,23,24],node:[0,22,23],non:[0,13,21],none:[0,7,12,13,14,15,17,19,21,22,23],norm:0,note:[7,12,22],notebook:0,noth:22,notic:0,num_attention_head:12,num_head:17,number:[0,13,20,22],numer:12,nvfuser:0,object:[20,22,23],obtain:0,od:22,old:22,old_mod:22,onc:12,one:[0,7,12,13,14,15,17,18,19,22,23],onli:[0,12,22,23],op:[0,10,22],oper:[0,12,13,21,22],optim:[1,2,4],option:[12,21,22,23],order:[12,22],ordereddict:22,org:0,organ:12,orig_act:18,origin:[0,7,15,21,22],original_nam:0,other:[0,13,22],otherwis:[15,22,23],our:[0,21],out:0,out_featur:[0,17,22],outdens:12,outer:23,output:[0,7,12,13,14,22,26],output_attent:12,output_proj:12,over:0,overhead:0,overridden:[7,12,13,14,15,17,18,19,22,23],p:[0,12,15],packag:[0,26],pair:22,paral:21,parallel:[14,15,21,22],parallelcrossentropi:14,param:[14,22],param_init_fn:[22,23],paramet:[0,7,11,12,14,15,17,20,21,22,23,24],parent:[22,23],part:[0,22],partial:[0,22],partit:[15,20,22],pass:[0,7,12,13,14,15,17,18,19,22,23],path:[7,23],pattern:[0,10,22,23],pattern_fn:23,pep:22,perform:[0,7,12,13,14,15,17,18,19,21,22,23],permut:0,permute_1:0,permute_2:0,permute_for_scor:0,pip:26,pipelin:[6,8,10,21,22,23],pipeline_cutting_path:[22,23],pipelinemodul:7,pleas:[0,12,23],pointer:21,pop:22,popitem:22,posit:12,pp_rank:[21,22],practic:0,present:22,preserv:0,prev_weight:13,primit:[0,4,22,23],print:[0,7,22,23,26],print_read:0,probabl:[0,12],process:[12,22],processgroup:[22,23],product:0,progress:[0,4],proj:0,proj_sch:0,project:[0,12],properli:22,provid:[0,22,23,26],purpos:21,put:[11,22],py:[0,2],pypi:26,python3:0,python:[0,4,26],pytorch:[0,4,12,22],q:[0,12],q_proj:0,qk:0,qkv:0,qkv_subgraph:0,queri:0,query_lay:12,query_padding_mask:12,r:[0,13],rais:22,ram:[11,22],random:[10,15,22],rang:14,rank:[7,14,21,22],re:22,readabl:0,reason:0,recip:[7,12,13,14,15,17,18,19,22,23],record:[22,23],recursivescriptmodul:0,reduc:[0,22],reduce_backward_grad:22,reduce_forward_output:22,reduce_scatter_forward_output:22,reflect:0,regex:23,regex_or_pattern_fn:23,region:[15,21],regist:[7,9,12,13,14,15,17,18,19,22,23],register_framework_dialect:9,register_primit:[22,23],registr:9,registri:8,regular:[0,23],relat:7,reli:[22,23],remain:0,rememb:22,remov:22,reorder:12,reorder_op:12,replac:[0,21],replai:[22,23],repr:22,repres:13,reproduc:[21,22],requir:[0,13],reset:[21,22],reshape_for_scor:12,reshaped_qkv:0,resid_pdrop:[12,18],residu:[0,23],restor:[7,22],result:22,ret:7,retriev:13,revers:7,rich:22,right:0,rng:[21,22],run:[0,7,12,13,14,15,17,18,19,22,23,26],runtim:[22,23],s:22,same:[0,12,15,17,20,21,22],satisfi:[0,23],save:[13,22],save_for_backward:13,save_for_forward:13,scale:[0,12],scaled_dot_product:0,scatter:22,scatter_forward_output:22,sch:[0,22,23],sch_metadata:7,schedul:[0,4,7,10,22],schedulemetadata:[7,22,23],script:0,seamlessli:0,second:0,see:[0,22],seed:[15,21,22],self:[0,12],self_attn:0,self_output:0,selfattent:[0,12],separ:0,seq:0,seq_len:0,seqlen_k:12,seqlen_q:12,sequenc:15,sequence_length:14,set:[0,4,20,21,22],set_random_se:[21,22],set_stat:21,setdefault:22,shallow:22,shape:[0,12],shard:[0,22,23],sharded_s:22,share:[20,22],should:[0,7,12,13,14,15,17,18,19,20,21,22,23],show:0,shown:0,signatur:12,silent:[7,12,13,14,15,17,18,19,22,23],similarli:0,simpl:22,simpler:0,simpli:0,sinc:[0,7,12,13,14,15,17,18,19,22,23],singl:[1,2,4],site:0,size:[13,21,22],slapo:[0,10,26],slice:0,sm:12,small:0,smooth:14,so:[0,20,21,22,23],softmax:[0,12],softmax_scal:12,sourc:[0,5,7,9,11,12,13,14,15,17,18,19,20,21,22,23,24,26],space:22,special:12,specif:[22,23],specifi:[0,11,22,23],sphinx:[0,1],split:[0,14,22],sqrt:[0,12],squeez:0,stabl:0,stage:[7,20,22,23],stage_id:7,stage_id_2_arg_nam:7,stage_modul:7,start:21,state:[0,21,22],statu:[22,23],still:0,store:[13,22],str:[7,12,20,22,23,24],string:[7,22],structur:[0,7],sub:23,subclass:[7,12,13,14,15,17,18,19,22,23],subgraph:[0,22,23],subgraphwrapp:23,submodul:[0,20,22,23],subschedul:0,successfulli:26,suffix:7,support:[0,12,20,22,23],suppos:15,sure:[0,7,15],symbol:22,sync:22,system:0,t1:7,t2:7,t:[0,13],take:[0,7,12,13,14,15,17,18,19,22,23,26],tape:[22,23],target:[9,14,22,23],tension:4,tensor:[0,7,12,13,14,15,17,21,22],tensor_parallel_output_grad:22,test:12,thei:13,them:[0,7,12,13,14,15,17,18,19,22,23],therefor:[11,22],thi:[0,7,11,12,13,14,15,17,18,19,20,21,22,23],thing:0,those:0,though:[0,13],three:0,through:[0,26],thu:[0,4],ti:[7,20,22],tie:[20,22],tie_group:[20,22],tie_weight:[22,23],tie_weight_group:7,time:0,to_dict:22,todo:[22,23],togeth:0,top:[0,20,22,23],top_mod:[20,22],topolog:[7,22,23],torch:[0,7,11,12,14,17,20,21,22],torchscript:0,total:[0,2],total_stag:7,tp_rank:[21,22],trace:[0,20,22,23,24],trace_for_pipelin:23,trace_modul:22,tracer:[0,10],track:[21,22],tracker:[21,22],tradit:0,train:[0,4],training_script_arg:22,transfer:22,transfer_hook:22,transfer_hooks_for_fus:22,transform:[0,13],transpos:[0,12],transpose_for_scor:12,triangular:12,triton:12,truediv:0,tunabl:22,tune:22,tupl:[12,13,20,22,23],tutori:0,two:[0,20,21,22,26],type:[0,7,12,13,15,17,19,20,21,22,23],under:[11,22],unflatten:7,union:23,unsafe_hash:22,until:23,upcast:12,updat:22,update_space_fn:22,us:[0,4,7,11,12,13,15,18,21,22,23],usabl:4,use_cach:12,use_reentr:22,user:[0,4],userwarn:0,usr:0,usual:0,v:[0,12,22],v_proj:0,val:22,valid:12,validate_sm_vers:12,valu:[0,7,13,22],value_lay:12,verifi:26,version:12,vertic:0,view:[0,22],view_1:0,view_2:0,vjp:13,vocab:14,vocab_parallel_cross_entropi:14,vocab_parallel_logit:14,w:13,wa:22,wai:[0,26],want:0,warn:[0,12],warning_onc:12,we:[0,7,12,15,21,22,23,26],weight:[0,7,20,22,23],were:13,when:[11,12,14,22,23,26],where:0,wherea:22,whether:[11,12,13,20,22,23],which:[0,11,15,22],whose:23,wise:0,within:[7,12,13,14,15,17,18,19,22,23],without:[4,7,12],work:0,world_siz:17,would:[11,22],wrap:[0,7,22,23],wrappedtypecod:7,wrapper:[12,18,20],x:[0,12,17,22,23],xformer:[0,12],xformers_ref:12,yet:22,you:[0,12,13,23,26]},titles:["Optimize Attention Module on A Single Device","Gallery","Computation times","Index","Slapo Documentation","slapo.framework_dialect.deepspeed.engine","slapo.framework_dialect.deepspeed","slapo.framework_dialect.deepspeed.pipeline","slapo.framework_dialect","slapo.framework_dialect.registry","Python API","slapo.initialization","slapo.op.attention","slapo.op.bias_gelu","slapo.op.cross_entropy","slapo.op.dropout","slapo.op","slapo.op.linear","slapo.op.mlp","slapo.pattern","slapo.pipeline","slapo.random","slapo","slapo.schedule","slapo.tracer","Gallery","Installation"],titleterms:{A:0,api:10,attent:[0,12],bias_gelu:13,comput:2,cross_entropi:14,deepspe:[5,6,7],devic:0,document:4,dropout:15,engin:5,framework_dialect:[5,6,7,8,9],galleri:[1,25],get:4,index:3,initi:11,instal:26,linear:17,mlp:18,modul:0,op:[12,13,14,15,16,17,18],optim:0,pattern:19,pipelin:[7,20],python:10,random:21,refer:4,registri:9,schedul:23,singl:0,slapo:[4,5,6,7,8,9,11,12,13,14,15,16,17,18,19,20,21,22,23,24],start:4,submodul:[6,8,16],time:2,tracer:24,tutori:4}})