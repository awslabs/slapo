Search.setIndex({docnames:["gallery/attention-single-gpu","gallery/index","gallery/quick-start","gallery/sg_execution_times","genindex","index","python_api/framework_dialect/deepspeed/engine","python_api/framework_dialect/deepspeed/index","python_api/framework_dialect/deepspeed/pipeline","python_api/framework_dialect/index","python_api/framework_dialect/registry","python_api/index","python_api/initialization","python_api/op/attention","python_api/op/bias_gelu","python_api/op/cross_entropy","python_api/op/dropout","python_api/op/index","python_api/op/linear","python_api/op/mlp","python_api/pattern","python_api/pipeline","python_api/random","python_api/root","python_api/schedule","python_api/tracer","scripts/README","setup/index"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":5,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,"sphinxcontrib.bibtex":9,sphinx:56},filenames:["gallery/attention-single-gpu.rst","gallery/index.rst","gallery/quick-start.rst","gallery/sg_execution_times.rst","genindex.rst","index.rst","python_api/framework_dialect/deepspeed/engine.rst","python_api/framework_dialect/deepspeed/index.rst","python_api/framework_dialect/deepspeed/pipeline.rst","python_api/framework_dialect/index.rst","python_api/framework_dialect/registry.rst","python_api/index.rst","python_api/initialization.rst","python_api/op/attention.rst","python_api/op/bias_gelu.rst","python_api/op/cross_entropy.rst","python_api/op/dropout.rst","python_api/op/index.rst","python_api/op/linear.rst","python_api/op/mlp.rst","python_api/pattern.rst","python_api/pipeline.rst","python_api/random.rst","python_api/root.rst","python_api/schedule.rst","python_api/tracer.rst","scripts/README.rst","setup/index.rst"],objects:{"":[[23,0,0,"-","slapo"]],"slapo.Database":[[23,2,1,"","commit"],[23,2,1,"","load"]],"slapo.LinearWithSeparateBias":[[23,2,1,"","forward"]],"slapo.ModulePattern":[[23,2,1,"","forward"]],"slapo.OrderedDict":[[23,2,1,"","clear"],[23,2,1,"","copy"],[23,2,1,"","fromkeys"],[23,2,1,"","items"],[23,2,1,"","keys"],[23,2,1,"","move_to_end"],[23,2,1,"","pop"],[23,2,1,"","popitem"],[23,2,1,"","setdefault"],[23,2,1,"","update"],[23,2,1,"","values"]],"slapo.Pattern":[[23,2,1,"","forward"]],"slapo.Space":[[23,2,1,"","cfg_dict_to_str"],[23,2,1,"","clone"],[23,2,1,"","create_symbol"],[23,2,1,"","log_space"],[23,2,1,"","next"],[23,2,1,"","reset"],[23,2,1,"","to_dict"]],"slapo.Symbol":[[23,2,1,"","add"],[23,2,1,"","fix_at"],[23,2,1,"","is_fixed"]],"slapo.framework_dialect":[[10,0,0,"-","registry"]],"slapo.framework_dialect.deepspeed":[[6,0,0,"-","engine"],[8,0,0,"-","pipeline"]],"slapo.framework_dialect.deepspeed.engine":[[6,4,1,"","init_ds_engine"]],"slapo.framework_dialect.deepspeed.pipeline":[[8,1,1,"","DeepSpeedPipeStageWrapper"],[8,1,1,"","WrappedTypeCode"],[8,4,1,"","analyze_tie_ranks"],[8,4,1,"","decode_metadata"],[8,4,1,"","deepspeed_pipe_engine"],[8,4,1,"","encode_metadata"],[8,4,1,"","flat_and_name_tensor_list"],[8,4,1,"","flatten"],[8,4,1,"","get_simple_nested_list_str"],[8,4,1,"","unflatten"]],"slapo.framework_dialect.deepspeed.pipeline.DeepSpeedPipeStageWrapper":[[8,2,1,"","forward"]],"slapo.framework_dialect.registry":[[10,4,1,"","get_all_dialects"],[10,4,1,"","get_dialect_cls"],[10,4,1,"","register_framework_dialect"]],"slapo.initialization":[[12,4,1,"","init_empty_weights"],[12,4,1,"","init_on_device"]],"slapo.op":[[13,0,0,"-","attention"],[14,0,0,"-","bias_gelu"],[15,0,0,"-","cross_entropy"],[16,0,0,"-","dropout"],[18,0,0,"-","linear"],[19,0,0,"-","mlp"]],"slapo.op.attention":[[13,1,1,"","AttentionOpWithRNG"],[13,1,1,"","FlashAttention"],[13,1,1,"","FlashAttentionOp"],[13,4,1,"","flash_attn_ref"],[13,4,1,"","get_xfoemers_attn_op_by_name"],[13,4,1,"","validate_sm_version"],[13,4,1,"","warning_once"],[13,4,1,"","xformers_ref"]],"slapo.op.attention.AttentionOpWithRNG":[[13,2,1,"","forward"]],"slapo.op.attention.FlashAttention":[[13,2,1,"","forward"],[13,2,1,"","reshape_for_scores"]],"slapo.op.attention.FlashAttentionOp":[[13,2,1,"","forward"]],"slapo.op.bias_gelu":[[14,1,1,"","BiasGeLUFunction"],[14,1,1,"","FusedBiasGELU"],[14,1,1,"","FusedBiasNewGELU"],[14,4,1,"","new_gelu"]],"slapo.op.bias_gelu.BiasGeLUFunction":[[14,2,1,"","backward"],[14,2,1,"","forward"]],"slapo.op.bias_gelu.FusedBiasGELU":[[14,2,1,"","forward"]],"slapo.op.bias_gelu.FusedBiasNewGELU":[[14,2,1,"","forward"]],"slapo.op.cross_entropy":[[15,1,1,"","ParallelCrossEntropy"],[15,4,1,"","vocab_parallel_cross_entropy"]],"slapo.op.cross_entropy.ParallelCrossEntropy":[[15,2,1,"","forward"]],"slapo.op.dropout":[[16,1,1,"","DropoutWithTensorParallel"]],"slapo.op.dropout.DropoutWithTensorParallel":[[16,2,1,"","forward"]],"slapo.op.linear":[[18,1,1,"","FusedQKV"],[18,1,1,"","LinearWithSeparateBias"]],"slapo.op.linear.FusedQKV":[[18,2,1,"","forward"]],"slapo.op.linear.LinearWithSeparateBias":[[18,2,1,"","forward"]],"slapo.op.mlp":[[19,1,1,"","FusedMLP"]],"slapo.op.mlp.FusedMLP":[[19,2,1,"","forward"]],"slapo.partial":[[23,3,1,"","args"],[23,3,1,"","func"],[23,3,1,"","keywords"]],"slapo.pattern":[[20,1,1,"","ModulePattern"],[20,1,1,"","Pattern"]],"slapo.pattern.ModulePattern":[[20,2,1,"","forward"]],"slapo.pattern.Pattern":[[20,2,1,"","forward"]],"slapo.pipeline":[[21,4,1,"","analyze_tie_weights"]],"slapo.random":[[22,1,1,"","CudaRNGStatesTracker"],[22,4,1,"","get_cuda_rng_tracker"],[22,4,1,"","is_random_seed_set"],[22,4,1,"","model_parallel_cuda_manual_seed"],[22,4,1,"","set_random_seed"]],"slapo.random.CudaRNGStatesTracker":[[22,2,1,"","add"],[22,2,1,"","fork"],[22,2,1,"","get_states"],[22,2,1,"","reset"],[22,2,1,"","set_states"]],"slapo.schedule":[[24,1,1,"","DictWithValidation"],[24,1,1,"","Schedule"],[24,1,1,"","ScheduleMetadata"],[24,1,1,"","SubgraphWrapper"],[24,4,1,"","consolidate_model"],[24,4,1,"","init_target_engine"],[24,4,1,"","register_primitive"]],"slapo.schedule.Schedule":[[24,2,1,"","find"],[24,2,1,"","find_node"],[24,2,1,"","find_subgraph"],[24,2,1,"","trace_for_pipeline"]],"slapo.schedule.SubgraphWrapper":[[24,2,1,"","forward"]],"slapo.tracer":[[25,4,1,"","trace"]],slapo:[[23,1,1,"","Database"],[23,1,1,"","DictWithValidation"],[23,3,1,"","FunctionType"],[23,1,1,"","LinearWithSeparateBias"],[23,1,1,"","ModulePattern"],[23,1,1,"","OrderedDict"],[23,1,1,"","Pattern"],[23,1,1,"","ScheduleMetadata"],[23,1,1,"","Space"],[23,1,1,"","Symbol"],[23,4,1,"","all_gather_forward_output"],[23,4,1,"","analyze_tie_weights"],[23,4,1,"","checkpoint"],[23,4,1,"","checkpoint_module"],[23,4,1,"","consolidate_model"],[23,4,1,"","dataclass"],[23,4,1,"","field"],[23,4,1,"","get_cuda_rng_tracker"],[23,4,1,"","get_dialect_cls"],[23,4,1,"","get_logger"],[23,4,1,"","get_output_type_after_sharding"],[23,4,1,"","init_empty_weights"],[23,4,1,"","init_target_engine"],[12,0,0,"-","initialization"],[23,4,1,"","is_random_seed_set"],[23,1,1,"","partial"],[20,0,0,"-","pattern"],[21,0,0,"-","pipeline"],[22,0,0,"-","random"],[23,4,1,"","reduce_backward_grad"],[23,4,1,"","reduce_forward_output"],[23,4,1,"","reduce_scatter_forward_output"],[23,4,1,"","register_primitive"],[23,4,1,"","scatter_forward_output"],[24,0,0,"-","schedule"],[23,4,1,"","set_random_seed"],[23,4,1,"","trace"],[23,4,1,"","trace_module"],[25,0,0,"-","tracer"],[23,4,1,"","transfer_hooks"],[23,4,1,"","transfer_hooks_for_fusion"]]},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","attribute","Python attribute"],"4":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:attribute","4":"py:function"},terms:{"0":[0,2,3,8,13,14,15,16,21,23],"00":[2,3],"05":0,"09":3,"1":[0,2,8,13,15,21,23,24],"10":2,"100":2,"1024":[0,2],"11":2,"12":2,"13":2,"14":2,"15":2,"154":[0,3],"16":[0,2],"17":2,"18":2,"181":[0,2],"19":2,"1e":[0,2],"2":[0,2,21,23,24],"20":[2,23],"2013":[22,23],"21":2,"22":2,"23":2,"3":[0,2],"30522":2,"3072":0,"3676bd2":13,"3x":0,"4":2,"4096":2,"48a77cc":13,"5":[2,16],"512":2,"526":23,"541":[2,3],"571":2,"6":2,"65":2,"695":3,"7":2,"8":[0,2],"9":2,"9kb":2,"boolean":14,"case":[0,2,16,23],"class":[0,2,8,10,13,14,15,16,18,19,20,22,23,24],"default":[0,2,15,22,23],"do":[0,2,13,22,23],"final":[0,23,24],"float":[13,16],"function":[0,2,6,8,10,12,13,14,15,16,18,19,20,21,22,23,24,25],"import":[0,2,27],"int":[8,13,18,21,22,23],"new":[0,2,14,23],"return":[0,2,8,13,14,16,18,20,21,22,23,24],"static":[0,2,14,23,24],"super":0,"throw":23,"true":[0,2,12,13,14,18,23],"try":[0,2,24],"while":[0,8,12,13,14,15,16,18,19,20,23,24],A:[1,3,5,8,12,13,19,23,24],As:[0,2],By:0,For:[0,2,8,22,23,24,27],If:[0,2,13,14,21,23,24,27],In:[0,16,23],It:[0,5,14,23],That:2,The:[0,2,8,13,14,16,21,23,24,27],Then:0,To:[0,2,27],_:0,__annotations__:23,__hash__:23,__init__:[0,2,23],__repr__:23,_c:[0,2],_check:[0,2],_missing_typ:23,_nn:[0,2],_proj:0,_stacklevel:0,abil:24,about:23,abov:[0,2,13],absolut:13,accept:[0,14],access:2,achiev:0,across:[15,22,23],activ:[14,23],actual:2,ad:[0,2,23],add:[0,2,22,23],add_1:0,add_2:0,addit:0,address:5,affect:0,after:[0,2,8,22,23],afterward:[8,13,14,15,16,18,19,20,23,24],again:0,alia:[14,23],all:[0,2,8,10,12,13,14,15,16,18,19,20,21,23,24],all_gather_forward_output:23,allow_non:[10,23],along:23,alreadi:[0,2,21,23],also:[0,2,12,14,22,23,27],although:[8,13,14,15,16,18,19,20,23,24],alwai:0,among:22,an:[0,2,12,13,14,23],analyz:[8,21,23],analyze_tie_rank:8,analyze_tie_weight:[21,23],ani:[0,2,14,21,23,24,25],annot:[0,2,23,24],anoth:0,aot:14,apart:0,api:[0,5,24],appli:[0,13],applic:[23,24],apply_causal_mask:[0,13],approach:27,ar:[0,2,8,12,14,15,18,21,22,23],arbitrari:14,arg:[8,14,20,23],argument:[0,8,14,18,23,24],assign:[8,22,23],attach:[0,23],attent:[1,2,3,5],attention_mask:[0,13],attention_output:0,attentionopwithrng:13,attn:0,attn_bia:13,attn_nam:13,attn_op_nam:[0,13],attn_pdrop:13,attn_prob:0,attn_sch:0,attn_scor:0,attribut:[0,2,14,23,24],auto:13,autoconfig:2,automat:14,avail:[12,23],awslab:27,axi:23,b:[2,23],back:13,backend:0,backward:14,base:[0,2,22,23],base_param:[23,24],basic:[0,22],batch_siz:[0,13,15],becaus:[23,24],becom:[0,23],been:[0,23],befor:23,begin:23,behavior:23,belong:24,below:0,bert:2,bertattent:2,bertembed:2,bertencod:2,bertintermedi:2,bertlay:2,bertlmheadmodel:2,bertlmpredictionhead:2,bertmodel:2,bertonlymlmhead:2,bertoutput:2,bertpredictionheadtransform:2,bertselfattent:2,bertselfoutput:2,between:5,bf16:13,bia:[0,2,13,14,18,19,23,24],bias_gelu_pattern:2,biasgelu:14,biasgelufunct:14,blow:[12,23],bodi:[0,2],bool:[12,13,16,18,21,23],both:[0,23],bs:0,buffer:[12,23],c:[0,27],call:[0,2,8,13,14,15,16,18,19,20,22,23,24],call_modul:[0,24],callabl:[23,24],can:[0,2,13,14,22,24,27],candid:23,cannot:[2,23],care:[8,13,14,15,16,18,19,20,23,24],cast:13,causal:13,cd:27,cfg_dict:23,cfg_dict_to_str:23,chang:[0,5,13,23,27],check:[0,13,22,23],checkpoint:23,checkpoint_modul:23,cl:[2,23],clear:23,clearli:0,click:[0,2],clone:[23,27],cls_type:[10,23],code:[0,2,8],codebas:27,com:[13,27],command:27,commit:[13,23],common:[0,5],commun:8,compar:[0,23],comparison:23,compat:[14,22],compil:[0,2],comput:[8,13,14,15,16,18,19,20,23,24],concrete_arg:0,conduct:[0,2],config:[2,8,23],connect:0,consequenti:[0,2],consist:0,consolid:[23,24],consolidate_model:[23,24],constraint:[0,24],consum:0,contain:[2,24],context:[12,14,23],contigu:0,control:0,converg:16,convert:[5,23],copi:[13,14,22,23],core:0,core_attn_subgraph:0,coreattent:[0,13],correct:[13,15],correctli:0,correspond:[0,14,23],cover:0,creat:[0,2,12,23,24],create_schedul:[0,2],create_symbol:23,creation:23,cross:[13,15],cross_entropi:17,ctx:14,cuda:[0,13,22,23],cudarngstatestrack:22,current:[0,14],custom:23,cut:24,cutlass:13,d:[13,23],d_k:0,data:[8,14,22,23],databas:23,dataclass:23,dataflow:[0,2,24],db:23,db_file_nam:23,debug:[0,2,23],debugg:0,decod:[2,8],decode_metadata:8,decompos:[0,2],decoupl:5,deep:0,deepspe:[9,23,24],deepspeed_pipe_engin:8,deepspeedpipestagewrapp:8,def:[0,2],default_factori:23,defin:[0,2,8,13,14,15,16,18,19,20,23,24],definit:[0,2,5],defint:2,dens:[0,2],dense_bia:[0,2],dense_weight:[0,2],depict:0,detail:23,determin:23,dev:27,develop:27,devic:[1,3,5,8,12,14,16,18,23],dialect:[10,23,24],dict:[8,21,23,24,25],dictionari:[22,23],dictwithvalid:[23,24],differ:[0,16,21,22,23,24],differenti:14,dim:[0,23],dimens:[0,15,23],dimseion:15,direct:22,directli:[0,2,5,14,24,27],dispatch:[0,24],dist:24,distribut:[15,23],doc:[0,23,24],documetn:13,doe:[0,23],doesn:[0,2],dot:0,download:[0,2],dp_rank:[22,23],dropout:[0,2,13,22],dropout_mask:13,dropout_p:13,dropoutwithtensorparallel:16,dtype:[0,14,18,23],due:[16,23],dunder:23,duplic:23,dure:14,e:[0,2,14,23,27],each:[0,8,14,16],easi:0,easier:24,easiest:27,easili:0,effect:27,effici:[0,5,13,22],either:[0,2,14,23],element:[0,2,23],elementwise_affin:[0,2],els:23,embed:[2,13],emploi:0,empti:[0,2,12,23],enabl:[5,12,23,24],encod:[2,8],encode_metadata:8,encoder_attention_mask:13,encoder_hidden_st:13,encount:13,end:23,enforc:14,engin:[7,8,9,23,24],enhanc:0,entropi:15,ep:[0,2],eq:23,equival:[13,14],error:[13,23],estim:13,etc:13,even:0,everi:[8,13,14,15,16,18,19,20,23,24],exactli:[0,2],examin:23,exampl:[0,2,8,22,23],execut:[3,5],exist:23,exit:22,explicitli:0,express:[0,24],f52868287ca9bd3ac1598dad6ce818358c1beafc:13,f:[0,2,23],facebookresearch:13,factor:15,factori:[23,24],fals:[0,2,10,12,13,16,23,24],feed:2,ffn:2,field:23,fifo:23,file:[3,23],find:[0,2,24],find_nod:24,find_subgraph:24,finish:0,first:[0,2,14,23],five:0,fix:23,fix_at:23,fixm:[23,24],flag:0,flash:13,flash_attention_op_0:0,flash_attn:0,flash_attn_ref:13,flashattent:13,flashattentionop:[0,13],flashattentionop_0:0,flashattentiontriton:13,flat:8,flat_and_name_tensor_list:8,flatten:[0,2,8],floattensor:13,follow:[0,2,13,14,23,27],footprint:23,fork:22,form:2,format:[8,24],former:[8,13,14,15,16,18,19,20,23,24],formula:14,forward:[0,2,8,13,14,15,16,18,19,20,23,24],found:23,fp16:[8,13],fp32:13,frac:0,framework:[0,10,21,23,24],framework_dialect:11,from:[0,2,5,8,13,14,18,21,23,24,27],from_pretrain:2,fromkei:23,frozen:23,full:[0,2],func:23,functiontyp:[23,24],further:23,fuse:[0,2,14,19,23],fused_bias_ge_lu_0:2,fused_layer_norm_0:0,fused_linear:0,fused_qkv:[0,13],fused_qkv_0:0,fusedbiasgelu:[2,14],fusedbiasgelu_0:2,fusedbiasnewgelu:14,fusedlayernorm:0,fusedlayernorm_0:0,fusedmlp:19,fusedqkv:[0,18],fusedqkv_0:0,fusion:[0,2,23],futur:23,fuzzi:0,fwd_pre:23,fx:[0,2,8,24],g:[0,2,14],galleri:[0,2,3],gather:23,gelu:[2,14,19],geluactiv:2,gemm:0,gener:[0,1,2,23,24],get:[0,2,10,13,22,23],get_all_dialect:10,get_cuda_rng_track:[22,23],get_dialect_cl:[10,23],get_logg:23,get_output_type_after_shard:23,get_simple_nested_list_str:8,get_stat:22,get_xfoemers_attn_op_by_nam:13,getattr_1:0,getattr_2:0,getattr_3:0,getattr_4:0,getitem:0,getitem_1:0,getitem_2:0,getitem_3:0,getitem_6:0,getitem_7:0,getitem_8:0,git:27,github:[13,27],give:0,given:[8,14,23,24],gpu:[0,3,8,22],grab:0,grad:14,grad_output:14,gradient:[14,23],gradual:0,graph:[0,2,24],graph_modul:[0,2],graphmodul:[0,2,8,23,25],greatli:0,group:[15,16,22,23,24],guid:[0,2],ha:[0,13,14,16,23],handl:0,hash:[13,23],have:[0,2,14,16,21,22,23,27],head:[0,13],head_dim:13,head_mask:13,help:[0,2],helper:8,here:[0,2,23],hf:13,hidden:0,hidden_s:[0,13,15,18,19],hidden_st:[0,2,13,18,19],hidet:11,hierach:2,hierarch:0,hierarchi:0,high:13,hook:[8,13,14,15,16,18,19,20,23,24],hook_typ:23,how:0,howev:23,hs:0,html:0,http:[0,13,27],hub:2,huggingfac:[2,13,14],hurt:16,i:2,id:[15,21,23],idea:0,identifi:23,idx:23,ignor:[8,13,14,15,16,18,19,20,23,24],implement:[0,2,13,18,23],implicitli:0,in_featur:[0,2,18,23],includ:[0,8,23,24],include_buff:[12,23],incorpor:0,inde:2,independ:0,index:[5,23],infer:23,info:[0,2],inform:8,init:23,init_ds_engin:6,init_empty_weight:[12,23],init_on_devic:12,init_target_engin:[23,24],initi:[6,11,22,23,24],inner:[2,24],inp:[14,23],inplac:[0,2,16],input:[0,13,14,16,18,22,23],input_tensor:0,insert:23,insid:24,instal:[0,2,5],instanc:[0,2,8,13,14,15,16,18,19,20,23,24],instanti:0,instead:[0,2,8,13,14,15,16,18,19,20,23,24],intend:14,inter:8,intermedi:2,intermediate_act_fn:2,intermediate_s:19,invok:[23,24],ipynb:[0,2],ir:0,is_decod:2,is_fix:23,is_pipeline_partit:[21,23],is_random_seed_set:[22,23],item:[8,23],iter:23,its:[0,2,23],itself:5,jfc4050:13,jit:[0,2],json:2,jupyt:[0,2],just:[0,2,12,14,22,23],jvp:14,k:[0,13,23],k_proj:0,keep:[0,23],kei:[0,2,23],kernel:[0,13,14,19],key_lay:13,key_padding_mask:13,keyerror:23,keyword:[2,8,23],kwarg:[6,8,14,23,24,25],label:15,label_smooth:15,lack:23,lambda:24,languag:5,larg:[2,5],last:23,later:[0,2,22,23,24],latter:[0,8,13,14,15,16,18,19,20,23,24],launch:0,layer:[0,2],layer_norm:0,layer_past:13,layernorm:[0,2],learn:0,left:0,len:8,let:[0,2],level:[0,2,21,23,24],leverag:[0,2],lib:[0,2],librari:0,lifo:23,like:23,limit:13,line:0,linear:[0,2,17,23],linearwithseparatebia:[0,2,18,23],list:[0,2,8,23,24],live:8,lm:[14,23],ln_pattern:0,ln_subgraph:0,load:[2,23],local:[0,2],locat:2,log:[13,23],log_spac:23,logger:23,logit:15,loss:15,loss_fn:8,lower:13,lve:2,made:0,mai:[0,16,23],main:2,mainli:[8,13],maintain:8,make:[0,2,8,16,19,23,24],manag:[12,22,23],mani:14,manual_se:22,map:[21,23],mask:[13,16],match:[0,21,23,24],math:13,mathrm:0,matmul:0,matmul_1:0,matrix:0,max_sm:13,maximum:13,mb:3,mean:[16,22,23],megatron:[14,23],memori:[21,23],merg:0,messag:13,meta:[12,23],metadata:[8,23],metadata_str:8,method:[8,13,14,15,16,18,19,20,22,23,24],micro_batch_s:15,middl:23,min_sm:13,minimum:13,minut:[0,2],mod:[0,2,8,24],mode:[14,23],model:[0,5,6,8,12,22,23,24,25],model_parallel_cuda_manual_se:22,modifi:[2,18,23],modul:[1,2,3,5,8,13,14,15,16,18,19,20,21,23,24,25],modulelist:2,modulepattern:[20,23],more:[0,2],most:[0,24],move:23,move_to_end:23,msg:13,much:0,multipl:0,must:[14,15,23],n_head:0,name:[0,2,8,13,20,21,22,23,24],nativ:13,native_flash_attn:13,native_xform:[0,13],necessari:0,need:[0,2,8,13,14,15,16,18,19,20,23,24],need_dist:[23,24],needs_input_grad:14,nest:8,network:2,new_gelu:14,new_mod:23,new_shap:0,next:[0,2,23],nhead:13,nn:[0,2,8,18,21,23,24,25],node:[0,2,23,24],non:[0,2,14,22],none:[0,2,8,13,14,15,16,18,20,22,23,24],norm:0,note:[8,13,23],notebook:[0,2],noth:23,notic:0,num_attention_head:13,num_head:18,number:[0,14,21,23],numer:13,nvfuser:0,object:[21,23,24],obtain:[0,2],od:23,old:23,old_mod:23,onc:13,one:[0,2,8,13,14,15,16,18,19,20,23,24],onli:[0,13,23,24],op:[0,11,23],oper:[0,2,13,14,22,23],optim:[1,3,5],option:[13,22,23,24],order:[2,13,23],ordereddict:23,org:0,organ:13,orig_act:19,origin:[0,2,8,16,22,23],original_nam:[0,2],other:[0,2,14,23],otherwis:[16,23,24],our:[0,22],out:0,out_featur:[0,2,18,23],outdens:13,outer:24,output:[0,2,8,13,14,15,23,27],output_attent:13,output_proj:13,over:0,overhead:0,overridden:[8,13,14,15,16,18,19,20,23,24],p:[0,2,13,16],packag:[0,2,27],padding_idx:2,pair:23,paral:22,parallel:[15,16,22,23],parallelcrossentropi:15,param:[15,23],param_init_fn:[23,24],paramet:[0,8,12,13,15,16,18,21,22,23,24,25],parent:[2,23,24],part:[0,2,23],partial:[0,23],partit:[16,21,23],pass:[0,2,8,13,14,15,16,18,19,20,23,24],path:[2,8,24],pattern:[0,2,11,23,24],pattern_fn:24,pep:23,perform:[0,2,8,13,14,15,16,18,19,20,22,23,24],permut:0,permute_1:0,permute_2:0,permute_for_scor:0,pip:27,pipelin:[7,9,11,22,23,24],pipeline_cutting_path:[23,24],pipelinemodul:8,pleas:[0,2,13,24],pointer:22,pop:23,popitem:23,posit:13,position_embed:2,pp_rank:[22,23],practic:0,predict:2,present:23,preserv:[0,2],prev_weight:14,primit:[0,2,5,23,24],print:[0,2,8,23,24,27],print_read:[0,2],probabl:[0,13],process:[13,23],processgroup:[23,24],product:0,progress:[0,5],proj:0,proj_sch:0,project:[0,13],properli:23,provid:[0,23,24,27],purpos:22,put:[12,23],py:[0,2,3],pypi:27,python3:[0,2],python:[0,2,5,27],pytorch:[0,5,13,23],q:[0,13],q_proj:0,qk:0,qkv:0,qkv_subgraph:0,queri:[0,2],query_lay:13,query_padding_mask:13,quick:[1,3,5],quickli:2,r:[0,14],rais:23,ram:[12,23],random:[16,23],rang:15,rank:[8,15,22,23],re:23,readabl:0,reason:0,recip:[8,13,14,15,16,18,19,20,23,24],record:[23,24],recursivescriptmodul:[0,2],reduc:[0,23],reduce_backward_grad:23,reduce_forward_output:23,reduce_scatter_forward_output:23,reflect:0,regex:24,regex_or_pattern_fn:24,region:[16,22],regist:[8,10,13,14,15,16,18,19,20,23,24],register_framework_dialect:10,register_primit:[23,24],registr:10,registri:9,regular:[0,24],relat:8,reli:[23,24],remain:0,rememb:23,remov:23,reorder:13,reorder_op:13,replac:[0,22],replai:[23,24],repr:23,reprent:2,repres:14,reproduc:[22,23],requir:[0,2,14],reset:[22,23],reshape_for_scor:13,reshaped_qkv:0,resid_pdrop:[13,19],residu:[0,24],restor:[8,23],result:[2,23],ret:8,retriev:[2,14],revers:8,rich:23,right:0,rng:[22,23],run:[0,2,8,13,14,15,16,18,19,20,23,24,27],runtim:[23,24],s:[2,23],same:[0,2,13,16,18,21,22,23],satisfi:[0,2,24],save:[14,23],save_for_backward:14,save_for_forward:14,scale:[0,13],scaled_dot_product:0,scatter:23,scatter_forward_output:23,sch:[0,2,23,24],sch_metadata:8,schedul:[0,2,5,8,11,23],schedulemetadata:[8,23,24],script:[0,2],seamlessli:0,second:[0,2],see:[0,2,23],seed:[16,22,23],self:[0,2,13],self_attn:0,self_output:0,selfattent:[0,13],separ:0,seq:0,seq_len:0,seqlen_k:13,seqlen_q:13,sequenc:16,sequence_length:15,set:[0,5,21,22,23],set_random_se:[22,23],set_stat:22,setdefault:23,shallow:23,shape:[0,13],shard:[0,2,23,24],sharded_s:23,share:[21,23],should:[0,2,8,13,14,15,16,18,19,20,21,22,23,24],show:0,shown:0,signatur:13,silent:[8,13,14,15,16,18,19,20,23,24],similarli:0,simpl:23,simpler:0,simpli:0,sinc:[0,2,8,13,14,15,16,18,19,20,23,24],singl:[1,3,5],site:[0,2],size:[14,22,23],slapo:[0,7,9,11,17,27],slice:0,sm:13,small:0,smooth:15,so:[0,21,22,23,24],softmax:[0,13],softmax_scal:13,sourc:[0,2,6,8,10,12,13,14,15,16,18,19,20,21,22,23,24,25,27],space:23,special:13,specif:[23,24],specifi:[0,2,12,23,24],sphinx:[0,1,2],split:[0,15,23],sqrt:[0,13],squeez:0,stabl:0,stage:[8,21,23,24],stage_id:8,stage_id_2_arg_nam:8,stage_modul:8,standalon:2,start:[1,3,22],state:[0,22,23],statu:[23,24],still:0,store:[2,14,23],str:[8,13,21,23,24,25],string:[8,23],structur:[0,2,8],sub:24,subclass:[8,13,14,15,16,18,19,20,23,24],subgraph:[0,2,23,24],subgraphwrapp:24,submodul:[0,2,21,23,24],subsch:2,subschedul:0,successfulli:27,suffix:8,support:[0,2,13,21,23,24],suppos:16,sure:[0,2,8,16],symbol:23,sync:23,system:[0,2],t1:8,t2:8,t:[0,2,14],take:[0,8,13,14,15,16,18,19,20,23,24,27],tape:[23,24],target:[10,15,23,24],tension:5,tensor:[0,2,8,13,14,15,16,18,22,23],tensor_parallel_output_grad:23,test:13,thei:[2,14],them:[0,8,13,14,15,16,18,19,20,23,24],therefor:[2,12,23],thi:[0,2,8,12,13,14,15,16,18,19,20,21,22,23,24],thing:0,those:0,though:[0,14],three:0,through:[0,2,27],thu:[0,5],ti:[8,21,23],tie:[21,23],tie_group:[21,23],tie_weight:[23,24],tie_weight_group:8,time:[0,2],to_dict:23,todo:[23,24],togeth:[0,2],token_type_embed:2,top:[0,21,23,24],top_mod:[21,23],topolog:[8,23,24],torch:[0,2,8,12,13,15,18,21,22,23],torchscript:[0,2],total:[0,2,3],total_stag:8,tp_rank:[22,23],trace:[0,2,21,23,24,25],trace_for_pipelin:24,trace_modul:23,tracer:[0,2,11],track:[22,23],tracker:[22,23],tradit:0,train:[0,5],training_script_arg:23,transfer:23,transfer_hook:23,transfer_hooks_for_fus:23,transform:[0,2,14],transform_act_fn:2,transpos:[0,13],transpose_for_scor:13,triangular:13,triton:13,truediv:0,tunabl:23,tune:23,tupl:[2,13,14,21,23,24],two:[0,2,21,22,23,27],type:[0,2,8,13,14,16,18,20,21,22,23,24],uncas:2,under:[12,23],unflatten:8,union:24,unsafe_hash:23,until:24,upcast:13,updat:23,update_space_fn:23,us:[0,2,5,8,12,13,14,16,19,22,23,24],usabl:5,use_cach:13,use_reentr:23,user:[0,2,5],userwarn:[0,2],usr:[0,2],usual:0,v:[0,13,23],v_proj:0,val:23,valid:13,validate_sm_vers:13,valu:[0,2,8,14,23],value_lay:13,vanilla:2,verifi:27,version:13,vertic:0,view:[0,23],view_1:0,view_2:0,vjp:14,vocab:15,vocab_parallel_cross_entropi:15,vocab_parallel_logit:15,w:14,wa:23,wai:[0,27],walk:2,want:[0,2],warn:[0,2,13],warning_onc:13,we:[0,2,8,13,16,22,23,24,27],weight:[0,2,8,21,23,24],were:14,what:2,when:[12,13,15,23,24,27],where:[0,2],wherea:23,whether:[12,13,14,21,23,24],which:[0,12,16,23],whose:24,wise:0,within:[8,13,14,15,16,18,19,20,23,24],without:[5,8,13],word_embed:2,work:0,world_siz:18,would:[12,23],wrap:[0,2,8,23,24],wrappedtypecod:8,wrapper:[13,19,21],x:[0,2,13,18,23,24],xformer:[0,13],xformers_ref:13,yet:23,you:[0,2,13,14,24,27]},titles:["Optimize Attention Module on A Single Device","Gallery","Quick Start","Computation times","Index","Slapo Documentation","slapo.framework_dialect.deepspeed.engine","hidet.framework_dialect.deepspeed","slapo.framework_dialect.deepspeed.pipeline","hidet.framework_dialect","slapo.framework_dialect.registry","Python API","slapo.initialization","slapo.op.attention","slapo.op.bias_gelu","slapo.op.cross_entropy","slapo.op.dropout","hidet.op","slapo.op.linear","slapo.op.mlp","slapo.pattern","slapo.pipeline","slapo.random","slapo","slapo.schedule","slapo.tracer","Gallery","Installation"],titleterms:{A:0,api:11,attent:[0,13],bias_gelu:14,comput:3,cross_entropi:15,deepspe:[6,7,8],devic:0,document:5,dropout:16,engin:6,framework_dialect:[6,7,8,9,10],galleri:[1,26],get:5,hidet:[7,9,17],index:4,initi:12,instal:27,linear:18,mlp:19,model:2,modul:0,op:[13,14,15,16,17,18,19],optim:[0,2],pattern:20,pipelin:[8,21],python:11,pytorch:2,quick:2,random:22,refer:5,registri:10,schedul:24,singl:0,slapo:[2,5,6,8,10,12,13,14,15,16,18,19,20,21,22,23,24,25],start:[2,5],submodul:[7,9,17],time:3,tracer:25,tutori:5}})